var ve=Object.defineProperty;var Ce=(e,t,o)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var y=(e,t,o)=>Ce(e,typeof t!="symbol"?t+"":t,o);import{i as Me,a as Se,r as f,j as r,L as Ne,b as je,u as P,c as Fe,d as te,e as ke,f as Ee,g as $e,h as Le,k as Te,l as Pe,m as De,n as Ae,o as Re,t as ze,p as Be,q as Ie,s as U,v as Oe,w as Ve,P as Ue}from"./vendor-D6UkCkPc.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function o(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(l){if(l.ep)return;l.ep=!0;const i=o(l);fetch(l.href,i)}})();const Xe={label:"File",tooltip:"Open the file menu"},_e={label:"New File",tooltip:"Create a new file",shortcut:"Ctrl+N"},He={label:"Open File",tooltip:"Open an existing file",shortcut:"Ctrl+O"},We={label:"Save File",tooltip:"Save the current file",shortcut:"Ctrl+S"},Ye={label:"Save As",tooltip:"Save the current file with a new name"},Ke={label:"Import File",tooltip:"Import a file into the project"},Ge={label:"Export",tooltip:"Export the current file"},Ze={label:"Export as PNG",tooltip:"Export the file as a PNG image"},qe={label:"Export as PDF",tooltip:"Export the file as a PDF document"},Je={label:"Export as CSV",tooltip:"Export the file as a CSV file"},Qe={label:"Print",tooltip:"Print the current file"},et={label:"Close File",tooltip:"Close the current file"},tt={label:"Edit",tooltip:"Open the edit menu"},ot={label:"Undo",tooltip:"Undo the last action",shortcut:"Ctrl+Z"},st={label:"Redo",tooltip:"Redo the last undone action",shortcut:"Ctrl+Y"},lt={label:"Cut",tooltip:"Cut the selected content",shortcut:"Ctrl+X"},it={label:"Copy",tooltip:"Copy the selected content",shortcut:"Ctrl+C"},nt={label:"Paste",tooltip:"Paste the copied content",shortcut:"Ctrl+V"},rt={label:"Duplicate",tooltip:"Duplicate the selected content",shortcut:"Ctrl+D"},at={label:"Select All",tooltip:"Select all content",shortcut:"Ctrl+A"},ct={label:"Find & Replace",tooltip:"Find and replace text",shortcut:"Ctrl+F"},dt={label:"View",tooltip:"Open the view menu"},ht={label:"Zoom In",tooltip:"Zoom in on the document",shortcut:"Ctrl++"},ut={label:"Zoom Out",tooltip:"Zoom out of the document",shortcut:"Ctrl+-"},pt={label:"Fit to Screen",tooltip:"Fit the content to the screen"},ft={label:"Toggle Grid",tooltip:"Show or hide the grid"},bt={label:"Toggle Guides",tooltip:"Show or hide the guides"},gt={label:"Fullscreen Mode",tooltip:"Switch to fullscreen mode",shortcut:"F11"},yt={label:"Shape",tooltip:"Open the shape menu"},mt={label:"Add Node",tooltip:"Add a new node to the diagram"},xt={label:"Delete Node",tooltip:"Delete the selected node"},wt={label:"Move Node",tooltip:"Move the selected node"},vt={label:"Resize Node",tooltip:"Resize the selected node"},Ct={label:"Rotate Node",tooltip:"Rotate the selected node"},Mt={label:"Change Node Color",tooltip:"Change the color of the selected node"},St={label:"Change Node Border",tooltip:"Change the border of the selected node"},Nt={label:"Change Node Text",tooltip:"Edit the text of the selected node"},jt={label:"Group Nodes",tooltip:"Group selected nodes together"},Ft={label:"Ungroup Nodes",tooltip:"Ungroup the selected nodes"},kt={label:"Lock Node",tooltip:"Lock the selected node"},Et={label:"Unlock Node",tooltip:"Unlock the selected node"},$t={label:"Connection",tooltip:"Open the connection menu"},Lt={label:"Add Edge",tooltip:"Add an edge between nodes"},Tt={label:"Delete Edge",tooltip:"Delete the selected edge"},Pt={label:"Change Edge Style",tooltip:"Change the style of the selected edge"},Dt={label:"Change Edge Color",tooltip:"Change the color of the selected edge"},At={label:"Change Edge Label",tooltip:"Change the label of the selected edge"},Rt={label:"Reverse Edge",tooltip:"Reverse the direction of the selected edge"},zt={label:"Text",tooltip:"Open the text menu"},Bt={label:"Add Text",tooltip:"Add text to the document"},It={label:"Edit Text",tooltip:"Edit the selected text"},Ot={label:"Change Font",tooltip:"Change the font of the selected text"},Vt={label:"Change Font Size",tooltip:"Change the font size of the selected text"},Ut={label:"Change Font Color",tooltip:"Change the font color of the selected text"},Xt={label:"Bold Text",tooltip:"Make the selected text bold",shortcut:"Ctrl+B"},_t={label:"Italic Text",tooltip:"Make the selected text italic",shortcut:"Ctrl+I"},Ht={label:"Underline Text",tooltip:"Underline the selected text",shortcut:"Ctrl+U"},Wt={label:"Align Text",tooltip:"Align the selected text"},Yt={label:"Layer",tooltip:"Open the layer menu"},Kt={label:"Send to Back",tooltip:"Send the selected layer to the back"},Gt={label:"Bring to Front",tooltip:"Bring the selected layer to the front"},Zt={label:"Send Backward",tooltip:"Send the selected layer one step backward"},qt={label:"Bring Forward",tooltip:"Bring the selected layer one step forward"},Jt={label:"Duplicate Layer",tooltip:"Duplicate the selected layer"},Qt={label:"Delete Layer",tooltip:"Delete the selected layer"},eo={label:"Toggle Layer Visibility",tooltip:"Show or hide the selected layer"},to={label:"Collaboration",tooltip:"Open the collaboration menu"},oo={label:"Add Comment",tooltip:"Add a comment to the document"},so={label:"Edit Comment",tooltip:"Edit the selected comment"},lo={label:"Delete Comment",tooltip:"Delete the selected comment"},io={label:"Share Document",tooltip:"Share the document with others"},no={file:Xe,newFile:_e,openFile:He,saveFile:We,saveAs:Ye,importFile:Ke,exportFile:Ge,exportFile_png:Ze,exportFile_pdf:qe,exportFile_csv:Je,print:Qe,closeFile:et,edit:tt,undo:ot,redo:st,cut:lt,copy:it,paste:nt,delete:{label:"Delete",tooltip:"Delete the selected content",shortcut:"Del"},duplicate:rt,selectAll:at,findReplace:ct,view:dt,zoomIn:ht,zoomOut:ut,fitToScreen:pt,toggleGrid:ft,toggleGuides:bt,fullscreenMode:gt,shape:yt,addNode:mt,deleteNode:xt,moveNode:wt,resizeNode:vt,rotateNode:Ct,changeNodeColor:Mt,changeNodeBorder:St,changeNodeText:Nt,groupNodes:jt,ungroupNodes:Ft,lockNode:kt,unlockNode:Et,connection:$t,addEdge:Lt,deleteEdge:Tt,changeEdgeStyle:Pt,changeEdgeColor:Dt,changeEdgeLabel:At,reverseEdge:Rt,text:zt,addText:Bt,editText:It,changeFont:Ot,changeFontSize:Vt,changeFontColor:Ut,boldText:Xt,italicText:_t,underlineText:Ht,alignText:Wt,layer:Yt,sendToBack:Kt,bringToFront:Gt,sendBackward:Zt,bringForward:qt,duplicateLayer:Jt,deleteLayer:Qt,toggleLayerVisibility:eo,collaboration:to,addComment:oo,editComment:so,deleteComment:lo,shareDocument:io},ro={"history-init":{label:"Init",tooltip:"Initialize the file"},"history-add":{label:"Add",tooltip:"Add modules to the file"},"history-delete":{label:"Delete",tooltip:"Delete modules from the file"},"history-paste":{label:"Paste",tooltip:"Paste modules into the file"},"history-duplicate":{label:"Duplicate",tooltip:"Duplicate selected modules"},"history-modify":{label:"Modify",tooltip:"Modify the properties of modules"},"history-move":{label:"Move",tooltip:"Move modules"},"history-reorder":{label:"Reorder",tooltip:"Reorder modules"},"history-select":{label:"Select",tooltip:"Select modules"},"history-group":{label:"Group",tooltip:"Group modules"},"history-ungroup":{label:"Ungroup",tooltip:"Ungroup modules"},"history-composite":{label:"Composite",tooltip:"Composite operation"}},ao={history:ro},co={label:"文件",tooltip:"打开文件菜单"},ho={label:"新建文件",tooltip:"创建新文件",shortcut:"Ctrl+N"},uo={label:"打开文件",tooltip:"打开现有文件",shortcut:"Ctrl+O"},po={label:"保存文件",tooltip:"保存当前文件",shortcut:"Ctrl+S"},fo={label:"另存为",tooltip:"以新名称保存当前文件"},bo={label:"导入文件",tooltip:"将文件导入到项目中"},go={label:"导出",tooltip:"导出当前文件"},yo={label:"导出为PNG",tooltip:"将文件导出为PNG图像"},mo={label:"导出为PDF",tooltip:"将文件导出为PDF文档"},xo={label:"导出为CSV",tooltip:"将文件导出为CSV文件"},wo={label:"打印",tooltip:"打印当前文件"},vo={label:"关闭文件",tooltip:"关闭当前文件"},Co={label:"编辑",tooltip:"打开编辑菜单"},Mo={label:"撤销",tooltip:"撤销上一步操作",shortcut:"Ctrl+Z"},So={label:"重做",tooltip:"重做上一次撤销的操作",shortcut:"Ctrl+Y"},No={label:"剪切",tooltip:"剪切选定的内容",shortcut:"Ctrl+X"},jo={label:"复制",tooltip:"复制选定的内容",shortcut:"Ctrl+C"},Fo={label:"粘贴",tooltip:"粘贴复制的内容",shortcut:"Ctrl+V"},ko={label:"复制",tooltip:"复制选定的内容",shortcut:"Ctrl+D"},Eo={label:"全选",tooltip:"选择所有内容",shortcut:"Ctrl+A"},$o={label:"查找和替换",tooltip:"查找和替换文本",shortcut:"Ctrl+F"},Lo={label:"视图",tooltip:"打开视图菜单"},To={label:"放大",tooltip:"放大文档",shortcut:"Ctrl++"},Po={label:"缩小",tooltip:"缩小文档",shortcut:"Ctrl+-"},Do={label:"适应屏幕",tooltip:"使内容适应屏幕"},Ao={label:"切换网格",tooltip:"显示或隐藏网格"},Ro={label:"切换参考线",tooltip:"显示或隐藏参考线"},zo={label:"全屏模式",tooltip:"切换到全屏模式",shortcut:"F11"},Bo={label:"形状",tooltip:"打开形状菜单"},Io={label:"添加节点",tooltip:"向图表添加新节点"},Oo={label:"删除节点",tooltip:"删除选定的节点"},Vo={label:"移动节点",tooltip:"移动选定的节点"},Uo={label:"调整节点大小",tooltip:"调整选定节点的大小"},Xo={label:"旋转节点",tooltip:"旋转选定的节点"},_o={label:"更改节点颜色",tooltip:"更改选定节点的颜色"},Ho={label:"更改节点边框",tooltip:"更改选定节点的边框"},Wo={label:"更改节点文本",tooltip:"编辑选定节点的文本"},Yo={label:"组合节点",tooltip:"将选定的节点组合在一起"},Ko={label:"取消组合节点",tooltip:"取消组合选定的节点"},Go={label:"锁定节点",tooltip:"锁定选定的节点"},Zo={label:"解锁节点",tooltip:"解锁选定的节点"},qo={label:"连接",tooltip:"打开连接菜单"},Jo={label:"添加边",tooltip:"在节点之间添加边"},Qo={label:"删除边",tooltip:"删除选定的边"},es={label:"更改边样式",tooltip:"更改选定边的样式"},ts={label:"更改边颜色",tooltip:"更改选定边的颜色"},os={label:"更改边标签",tooltip:"更改选定边的标签"},ss={label:"反转边",tooltip:"反转选定边的方向"},ls={label:"文本",tooltip:"打开文本菜单"},is={label:"添加文本",tooltip:"向文档添加文本"},ns={label:"编辑文本",tooltip:"编辑选定的文本"},rs={label:"更改字体",tooltip:"更改选定文本的字体"},as={label:"更改字体大小",tooltip:"更改选定文本的字体大小"},cs={label:"更改字体颜色",tooltip:"更改选定文本的字体颜色"},ds={label:"粗体文本",tooltip:"将选定的文本设置为粗体",shortcut:"Ctrl+B"},hs={label:"斜体文本",tooltip:"将选定的文本设置为斜体",shortcut:"Ctrl+I"},us={label:"下划线文本",tooltip:"为选定的文本添加下划线",shortcut:"Ctrl+U"},ps={label:"对齐文本",tooltip:"对齐选定的文本"},fs={label:"图层",tooltip:"打开图层菜单"},bs={label:"置于底层",tooltip:"将选定的图层置于底层"},gs={label:"置于顶层",tooltip:"将选定的图层置于顶层"},ys={label:"下移一层",tooltip:"将选定的图层下移一层"},ms={label:"上移一层",tooltip:"将选定的图层上移一层"},xs={label:"复制图层",tooltip:"复制选定的图层"},ws={label:"删除图层",tooltip:"删除选定的图层"},vs={label:"切换图层可见性",tooltip:"显示或隐藏选定的图层"},Cs={label:"协作",tooltip:"打开协作菜单"},Ms={label:"添加评论",tooltip:"向文档添加评论"},Ss={label:"编辑评论",tooltip:"编辑选定的评论"},Ns={label:"删除评论",tooltip:"删除选定的评论"},js={label:"分享文档",tooltip:"与他人分享文档"},Fs={file:co,newFile:ho,openFile:uo,saveFile:po,saveAs:fo,importFile:bo,exportFile:go,exportFile_png:yo,exportFile_pdf:mo,exportFile_csv:xo,print:wo,closeFile:vo,edit:Co,undo:Mo,redo:So,cut:No,copy:jo,paste:Fo,delete:{label:"删除",tooltip:"删除选定的内容",shortcut:"Del"},duplicate:ko,selectAll:Eo,findReplace:$o,view:Lo,zoomIn:To,zoomOut:Po,fitToScreen:Do,toggleGrid:Ao,toggleGuides:Ro,fullscreenMode:zo,shape:Bo,addNode:Io,deleteNode:Oo,moveNode:Vo,resizeNode:Uo,rotateNode:Xo,changeNodeColor:_o,changeNodeBorder:Ho,changeNodeText:Wo,groupNodes:Yo,ungroupNodes:Ko,lockNode:Go,unlockNode:Zo,connection:qo,addEdge:Jo,deleteEdge:Qo,changeEdgeStyle:es,changeEdgeColor:ts,changeEdgeLabel:os,reverseEdge:ss,text:ls,addText:is,editText:ns,changeFont:rs,changeFontSize:as,changeFontColor:cs,boldText:ds,italicText:hs,underlineText:us,alignText:ps,layer:fs,sendToBack:bs,bringToFront:gs,sendBackward:ys,bringForward:ms,duplicateLayer:xs,deleteLayer:ws,toggleLayerVisibility:vs,collaboration:Cs,addComment:Ms,editComment:Ss,deleteComment:Ns,shareDocument:js},ks={"history-init":{label:"初始化",tooltip:"初始化文件"},"history-add":{label:"添加",tooltip:"向文件添加模块"},"history-delete":{label:"删除",tooltip:"从文件中删除模块"},"history-paste":{label:"粘贴",tooltip:"将模块粘贴到文件中"},"history-duplicate":{label:"复制",tooltip:"复制选定的模块"},"history-modify":{label:"修改",tooltip:"修改模块的属性"},"history-move":{label:"移动",tooltip:"移动模块"},"history-reorder":{label:"重新排序",tooltip:"重新排序模块"},"history-select":{label:"选择",tooltip:"选择模块"},"history-group":{label:"组合",tooltip:"组合模块"},"history-ungroup":{label:"取消组合",tooltip:"取消模块组合"},"history-composite":{label:"复合操作",tooltip:"复合操作"}},Es={history:ks},$s={label:"ファイル",tooltip:"ファイルメニューを開く"},Ls={label:"新規ファイル",tooltip:"新規ファイルを作成",shortcut:"Ctrl+N"},Ts={label:"ファイルを開く",tooltip:"既存のファイルを開く",shortcut:"Ctrl+O"},Ps={label:"ファイルを保存",tooltip:"現在のファイルを保存",shortcut:"Ctrl+S"},Ds={label:"名前を付けて保存",tooltip:"現在のファイルに新しい名前を付けて保存"},As={label:"ファイルをインポート",tooltip:"プロジェクトにファイルをインポート"},Rs={label:"エクスポート",tooltip:"現在のファイルをエクスポート"},zs={label:"PNGとしてエクスポート",tooltip:"ファイルをPNG画像としてエクスポート"},Bs={label:"PDFとしてエクスポート",tooltip:"ファイルをPDFドキュメントとしてエクスポート"},Is={label:"CSVとしてエクスポート",tooltip:"ファイルをCSVファイルとしてエクスポート"},Os={label:"印刷",tooltip:"現在のファイルを印刷"},Vs={label:"ファイルを閉じる",tooltip:"現在のファイルを閉じる"},Us={label:"編集",tooltip:"編集メニューを開く"},Xs={label:"元に戻す",tooltip:"最後のアクションを元に戻す",shortcut:"Ctrl+Z"},_s={label:"やり直し",tooltip:"最後に元に戻したアクションをやり直す",shortcut:"Ctrl+Y"},Hs={label:"切り取り",tooltip:"選択したコンテンツを切り取り",shortcut:"Ctrl+X"},Ws={label:"コピー",tooltip:"選択したコンテンツをコピー",shortcut:"Ctrl+C"},Ys={label:"貼り付け",tooltip:"コピーしたコンテンツを貼り付け",shortcut:"Ctrl+V"},Ks={label:"複製",tooltip:"選択したコンテンツを複製",shortcut:"Ctrl+D"},Gs={label:"すべて選択",tooltip:"すべてのコンテンツを選択",shortcut:"Ctrl+A"},Zs={label:"検索と置換",tooltip:"テキストを検索して置換",shortcut:"Ctrl+F"},qs={label:"表示",tooltip:"表示メニューを開く"},Js={label:"拡大",tooltip:"ドキュメントを拡大",shortcut:"Ctrl++"},Qs={label:"縮小",tooltip:"ドキュメントを縮小",shortcut:"Ctrl+-"},el={label:"画面に合わせる",tooltip:"コンテンツを画面に合わせる"},tl={label:"グリッドの切り替え",tooltip:"グリッドを表示または非表示"},ol={label:"ガイドの切り替え",tooltip:"ガイドを表示または非表示"},sl={label:"全画面モード",tooltip:"全画面モードに切り替え",shortcut:"F11"},ll={label:"図形",tooltip:"図形メニューを開く"},il={label:"ノードを追加",tooltip:"ダイアグラムに新しいノードを追加"},nl={label:"ノードを削除",tooltip:"選択したノードを削除"},rl={label:"ノードを移動",tooltip:"選択したノードを移動"},al={label:"ノードのサイズを変更",tooltip:"選択したノードのサイズを変更"},cl={label:"ノードを回転",tooltip:"選択したノードを回転"},dl={label:"ノードの色を変更",tooltip:"選択したノードの色を変更"},hl={label:"ノードの境界線を変更",tooltip:"選択したノードの境界線を変更"},ul={label:"ノードのテキストを変更",tooltip:"選択したノードのテキストを編集"},pl={label:"ノードをグループ化",tooltip:"選択したノードをグループ化"},fl={label:"ノードのグループ化を解除",tooltip:"選択したノードのグループ化を解除"},bl={label:"ノードをロック",tooltip:"選択したノードをロック"},gl={label:"ノードのロックを解除",tooltip:"選択したノードのロックを解除"},yl={label:"接続",tooltip:"接続メニューを開く"},ml={label:"エッジを追加",tooltip:"ノード間にエッジを追加"},xl={label:"エッジを削除",tooltip:"選択したエッジを削除"},wl={label:"エッジのスタイルを変更",tooltip:"選択したエッジのスタイルを変更"},vl={label:"エッジの色を変更",tooltip:"選択したエッジの色を変更"},Cl={label:"エッジのラベルを変更",tooltip:"選択したエッジのラベルを変更"},Ml={label:"エッジの方向を反転",tooltip:"選択したエッジの方向を反転"},Sl={label:"テキスト",tooltip:"テキストメニューを開く"},Nl={label:"テキストを追加",tooltip:"ドキュメントにテキストを追加"},jl={label:"テキストを編集",tooltip:"選択したテキストを編集"},Fl={label:"フォントを変更",tooltip:"選択したテキストのフォントを変更"},kl={label:"フォントサイズを変更",tooltip:"選択したテキストのフォントサイズを変更"},El={label:"フォントの色を変更",tooltip:"選択したテキストのフォントの色を変更"},$l={label:"テキストを太字にする",tooltip:"選択したテキストを太字にする",shortcut:"Ctrl+B"},Ll={label:"テキストを斜体にする",tooltip:"選択したテキストを斜体にする",shortcut:"Ctrl+I"},Tl={label:"テキストに下線を引く",tooltip:"選択したテキストに下線を引く",shortcut:"Ctrl+U"},Pl={label:"テキストを配置",tooltip:"選択したテキストを配置"},Dl={label:"レイヤー",tooltip:"レイヤーメニューを開く"},Al={label:"最背面へ移動",tooltip:"選択したレイヤーを最背面へ移動"},Rl={label:"最前面へ移動",tooltip:"選択したレイヤーを最前面へ移動"},zl={label:"背面へ移動",tooltip:"選択したレイヤーを1つ背面へ移動"},Bl={label:"前面へ移動",tooltip:"選択したレイヤーを1つ前面へ移動"},Il={label:"レイヤーを複製",tooltip:"選択したレイヤーを複製"},Ol={label:"レイヤーを削除",tooltip:"選択したレイヤーを削除"},Vl={label:"レイヤーの表示/非表示を切り替え",tooltip:"選択したレイヤーの表示/非表示を切り替え"},Ul={label:"コラボレーション",tooltip:"コラボレーションメニューを開く"},Xl={label:"コメントを追加",tooltip:"ドキュメントにコメントを追加"},_l={label:"コメントを編集",tooltip:"選択したコメントを編集"},Hl={label:"コメントを削除",tooltip:"選択したコメントを削除"},Wl={label:"ドキュメントを共有",tooltip:"ドキュメントを他のユーザーと共有"},Yl={file:$s,newFile:Ls,openFile:Ts,saveFile:Ps,saveAs:Ds,importFile:As,exportFile:Rs,exportFile_png:zs,exportFile_pdf:Bs,exportFile_csv:Is,print:Os,closeFile:Vs,edit:Us,undo:Xs,redo:_s,cut:Hs,copy:Ws,paste:Ys,delete:{label:"削除",tooltip:"選択したコンテンツを削除",shortcut:"Del"},duplicate:Ks,selectAll:Gs,findReplace:Zs,view:qs,zoomIn:Js,zoomOut:Qs,fitToScreen:el,toggleGrid:tl,toggleGuides:ol,fullscreenMode:sl,shape:ll,addNode:il,deleteNode:nl,moveNode:rl,resizeNode:al,rotateNode:cl,changeNodeColor:dl,changeNodeBorder:hl,changeNodeText:ul,groupNodes:pl,ungroupNodes:fl,lockNode:bl,unlockNode:gl,connection:yl,addEdge:ml,deleteEdge:xl,changeEdgeStyle:wl,changeEdgeColor:vl,changeEdgeLabel:Cl,reverseEdge:Ml,text:Sl,addText:Nl,editText:jl,changeFont:Fl,changeFontSize:kl,changeFontColor:El,boldText:$l,italicText:Ll,underlineText:Tl,alignText:Pl,layer:Dl,sendToBack:Al,bringToFront:Rl,sendBackward:zl,bringForward:Bl,duplicateLayer:Il,deleteLayer:Ol,toggleLayerVisibility:Vl,collaboration:Ul,addComment:Xl,editComment:_l,deleteComment:Hl,shareDocument:Wl},Kl={"history-init":{label:"初期化",tooltip:"ファイルを初期化する"},"history-add":{label:"追加",tooltip:"ファイルにモジュールを追加する"},"history-delete":{label:"削除",tooltip:"ファイルからモジュールを削除する"},"history-paste":{label:"貼り付け",tooltip:"ファイルにモジュールを貼り付ける"},"history-duplicate":{label:"複製",tooltip:"選択したモジュールを複製する"},"history-modify":{label:"修正",tooltip:"モジュールのプロパティを修正する"},"history-move":{label:"移動",tooltip:"モジュールを移動する"},"history-reorder":{label:"並べ替え",tooltip:"モジュールを並べ替える"},"history-select":{label:"選択",tooltip:"モジュールを選択する"},"history-group":{label:"グループ化",tooltip:"モジュールをグループ化する"},"history-ungroup":{label:"グループ化解除",tooltip:"モジュールのグループ化を解除する"},"history-composite":{label:"複合操作",tooltip:"複合操作"}},Gl={history:Kl},Zl={en:{translation:{...no,...ao}},cn:{translation:{...Fs,...Es}},jp:{translation:{...Yl,...Gl}}};Me.use(Se).init({resources:Zl,lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});const X=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),_=f.createContext({fileMap:new Map([["fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",{id:"fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",name:"Untitled 1",config:{},data:{}}]]),fileList:[],currentFileId:"fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",creating:!1,switchFile:()=>{},closeFile:()=>{},createFile:()=>{},handleCreating:()=>{}}),ql=({bg:e="#fff",onBgClick:t})=>{const o=f.useRef(null),{createFile:s,handleCreating:l}=f.useContext(_),[i,n]=f.useState(""),a=d=>/^[a-zA-Z0-9-_ ]+$/.test(d),c=d=>{var p;d.preventDefault(),d.stopPropagation();const h=(p=o.current)==null?void 0:p.filename.value.trim();if(!a(h)){n("File name can only including number space and alpha");return}n("");const u={id:X(),name:h,data:{},config:{}};s(u),l(!1)};return r.jsxs("div",{className:"fixed top-0 left-0 z-20 w-full h-full flex flex-row items-center justify-center text-sm select-none",children:[r.jsx("div",{style:{backgroundColor:e},onClick:()=>t&&t(),className:"absolute top-0 left-0 w-full h-full flex flex-row items-center justify-center text-sm select-none"}),r.jsxs("form",{ref:o,className:"relative w-100 min-h-30 z-20 p-4 bg-white rounded-xl shadow-2xl",onSubmit:c,children:[r.jsx("h1",{className:"text-xl text-center",children:"New File"}),r.jsx("label",{htmlFor:"filename",className:"block text-gray-700 font-medium mb-2",children:"File Name"}),r.jsx("input",{type:"text",autoFocus:!0,id:"filename",name:"filename",placeholder:"Enter file name",className:"w-full bg-gray-100 border border-gray-300 text-gray-700 py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"}),i&&r.jsx("div",{className:"text-red-500 my-2",children:i}),r.jsx("label",{className:"justify-center",children:r.jsx("button",{type:"submit",className:"mt-2 w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300",children:"Create File"})})]})]})};class Z{constructor(t,o,s,l=-1){y(this,"data");y(this,"prev");y(this,"next");y(this,"id");this.data=s,this.prev=t,this.next=o,this.id=l}}class Jl{constructor(){y(this,"head");y(this,"tail");y(this,"current");this.head=null,this.tail=null,this.current=null}detach(){return this.current&&(this.current.next=null,this.tail=this.current),this.current}append(t){let o;const{tail:s}=this;return s?(o=new Z(s,null,t,s.id+1),s.next=o,this.tail=o):(o=new Z(null,null,t,0),this.head=o,this.tail=o),this.current=o,o}back(){return this.current===this.head?!1:(this.current=this.current.prev,this.current)}forward(){return this.current===this.tail?!1:(this.current=this.current.next,this.current)}compareToCurrentPosition(t){if(t===this.current)return"equal";let o=this.head;for(;o;){if(this.current===o)return"behind";if(t===o)return"front";o=o.next}return!1}destroy(){this.head=null,this.tail=null,this.current=null}}class Ql extends Jl{constructor(o){super();y(this,"editor");this.editor=o,this.init()}init(){var o,s;this.append({type:"history-init",payload:{state:null,selectedModules:new Set}}),(s=(o=this.editor.events).onHistoryUpdated)==null||s.call(o,this)}add(o){var s,l;this.detach(),this.append(o),(l=(s=this.editor.events).onHistoryUpdated)==null||l.call(s,this)}toArray(){const o=[];if(this.head){let s=this.head;for(o.push(s);s.next;)o.push(s.next),s=s.next}return o}compareToCurrentPosition(o){return super.compareToCurrentPosition(o)}forward(){return super.forward()}back(){return super.back()}}class ei{constructor(){y(this,"eventsMap",new Map)}on(t,o){this.eventsMap.has(t)?this.eventsMap.get(t).push(o):this.eventsMap.set(t,[o])}off(t,o){if(this.eventsMap.has(t)){const s=this.eventsMap.get(t);for(let l=s.length-1;l>=0;l--)if(s[l]===o)return s.splice(l,1),"deleted";return"Cannot find event or function"}}dispatch(t,o){console.info("action: ",t),this.eventsMap.has(t)&&this.eventsMap.get(t).forEach(s=>{s(o)})}execute(t,o){this.dispatch(t,o)}destroy(){this.eventsMap.clear()}}const ti=({x:e,y:t,width:o,height:s},l)=>{const i=e+o/2,n=t+s/2,a=l*Math.PI/180,c=Math.cos(a),d=Math.sin(a),h=Math.abs(o*c)+Math.abs(s*d),u=Math.abs(o*d)+Math.abs(s*c),p=i-h/2,m=n-u/2;return H({x:p,y:m,width:h,height:u})},H=e=>{const{x:t,y:o,width:s,height:l}=e;return{x:t,y:o,width:s,height:l,top:o,bottom:o+l,left:t,right:t+s,cx:t+s/2,cy:o+l/2}},k=(e,t)=>{const o=Math.min(e.x,t.x),s=Math.max(e.x,t.x),l=Math.min(e.y,t.y),i=Math.max(e.y,t.y);return H({x:o,y:l,width:s-o,height:i-l})};function oi(e,t){return!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function si(e,t){return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom}const li=({x:e,y:t},o,s)=>{const{x:l,y:i,width:n,height:a}=o;if(n<=0||a<=0)return!1;if(s===0){const w=n/2,v=a/2;return e>=l-w&&e<=l+w&&t>=i-v&&t<=i+v}const c=s*(Math.PI/180),d=Math.cos(c),h=Math.sin(c),u=e-l,p=t-i,m=u*d+p*h,g=-u*h+p*d,b=n/2,x=a/2;return m>=-b&&m<=b&&g>=-x&&g<=x},B=e=>e===0&&1/e===-1/0;function ii(e,t){let o=0,s;return(...l)=>{const i=Date.now(),n=()=>{o=i,e(...l)};i-o>=t?n():(s!==void 0&&clearTimeout(s),s=setTimeout(n,t-(i-o)))}}function oe(e){return e===null?"null":e===void 0?"undefined":e instanceof Set?"set":e instanceof Map?"map":Array.isArray(e)?"array":e instanceof Date?"date":e instanceof RegExp?"regexp":e instanceof Error?"error":e instanceof Promise?"promise":e instanceof ArrayBuffer?"arraybuffer":ArrayBuffer.isView(e)?"typedarray":e instanceof WeakSet?"weakset":e instanceof WeakMap?"weakmap":typeof e=="function"?"function":typeof e=="symbol"?"symbol":typeof e=="bigint"?"bigint":typeof e=="object"?"object":typeof e}function O(e,t={}){if(typeof e!="object"||e===null)return e;if(Array.isArray(e))return e.map(s=>O(s,t));const o=Object.create(t.clonePrototype?Object.getPrototypeOf(e):null);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(o[s]=O(e[s],t));return o}class se{constructor({id:t,type:o,lineColor:s,lineWidth:l=1,opacity:i=100,layer:n=1,rotation:a=0,shadow:c=!1,enableLine:d=!0}){y(this,"id");y(this,"type");y(this,"enableLine");y(this,"lineWidth");y(this,"lineColor");y(this,"opacity");y(this,"rotation");y(this,"shadow");y(this,"layer");this.id=t,this.type=o,this.enableLine=d,this.lineColor=s,this.lineWidth=l,this.opacity=i,this.rotation=a,this.shadow=c,this.layer=n}getDetails(){return{id:this.id,type:this.type,enableLine:this.enableLine,lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,shadow:this.shadow,layer:this.layer,rotation:this.rotation}}getBoundingRect(){return{x:0,y:0,width:0,height:0,top:0,left:0,right:0,bottom:0,cx:0,cy:0}}}class ni extends se{constructor({x:o,y:s,fillColor:l,enableFill:i=!0,width:n,height:a,...c}){super(c);y(this,"x");y(this,"y");y(this,"width");y(this,"height");y(this,"fillColor");y(this,"enableFill");this.x=o,this.y=s,this.width=n,this.height=a,this.fillColor=l,this.enableFill=i}getDetails(){return{...this.getSize(),fillColor:this.fillColor,enableFill:this.enableFill,x:this.x,y:this.y,width:this.width,height:this.height,...super.getDetails()}}getSize(){return{width:0,height:0}}getBoundingRect(){const{x:o,y:s,width:l,height:i,rotation:n}=this,a=o-l/2,c=s-i/2;return n===0?{x:a,y:c,width:l,height:i,left:a,top:c,right:a+l,bottom:c+i,cx:o,cy:s}:ti({x:a,y:c,width:l,height:i},n)}move(o,s){this.x+=o,this.y+=s}}class ri extends ni{constructor({...t}){super(t)}getDetails(){return super.getDetails()}getBoundingRect(){return super.getBoundingRect()}}class ai extends se{constructor({start:o,end:s,...l}){super(l);y(this,"start");y(this,"end");this.start=o,this.end=s}getDetails(){return{...this.getSize(),...super.getDetails()}}getSize(){return{width:100,height:100}}getBoundingRect(){const{x:o,y:s}={x:0,y:1},{width:l,height:i}=this.getSize();return{x:o,y:s,width:l,height:i,top:s,left:o,right:o+l,bottom:s+i}}}function ci(e){const t=O(e),o=new Map,s=l=>{if(l.id||(l.id=this.createModuleId),l.type==="rectangle")return new ri(l);if(l.type==="connector")return new ai(l)};return t.forEach(l=>{const i=s.call(this,l);o.set(l.id,i)}),o}function di(e){var t,o;return e.forEach(s=>{this.moduleMap.set(s.id,s)}),(o=(t=this.events).onModulesUpdated)==null||o.call(t,this.moduleMap),e}function hi(e,t=!1,o){const s=[],l=new Map;return e.forEach(i=>{const n=this.moduleMap.get(i);n&&l.set(i,n)}),l.forEach(i=>{const n=i.getDetails();t&&delete n.id,oe(o)==="object"&&Object.assign(n,o),s.push(n)}),s}function ui(e){const t=this.batchCopy(e);return t.forEach(o=>{this.moduleMap.delete(o.id)}),t}function pi(e,t){this.getModulesByIdSet(e).forEach(s=>{s.x+=t.x,s.y+=t.y})}function fi(e,t,o){this.getModulesByIdSet(e).forEach(l=>{Object.keys(t).forEach(i=>{const n=t[i];(typeof n=="string"||typeof n=="number")&&(l[i]=n)})})}const le=(e,t,o,s,l)=>{const i=o/2,n=s/2,a=l*(Math.PI/180),c=Math.cos(a),d=Math.sin(a);return[{x:e-i,y:t-n},{x:e,y:t-n},{x:e+i,y:t-n},{x:e+i,y:t},{x:e+i,y:t+n},{x:e,y:t+n},{x:e-i,y:t+n},{x:e-i,y:t}].map(({x:u,y:p})=>{const m=u-e,g=p-t;return{x:e+m*c-g*d,y:t+m*d+g*c}})};function ie(e,t,o,s,l){return{x:(s-t)/e,y:(l-o)/e}}const bi=({ctx:e,mousePoint:t,scale:o,dpr:s,offset:{x:l,y:i},virtualRect:{left:n,top:a,right:c,bottom:d}})=>{const h=10/(s*o),u=10/(s*o),{x:p,y:m}=ie(o,l*s,i*s,t.x*s,t.y*s),g="#ff0000",b="#ff0000",x="#000";e.save(),e.textBaseline="alphabetic",e.font=`${24/o}px sans-serif`,e.fillStyle=b,e.shadowColor=g,e.shadowBlur=1,e.fillText(`${Math.floor(p)}, ${Math.floor(m)}`,p+h,m-u,200/o),e.lineWidth=2/(s*o),e.strokeStyle=g,e.shadowColor=x,e.shadowBlur=0,e.beginPath(),e.moveTo(n,m),e.lineTo(c,m),e.moveTo(p,a),e.lineTo(p,d),e.stroke(),e.restore()},gi=(e,t)=>{if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0},yi=(e,t)=>{const o=new Set;for(const s of e)t.has(s)||o.add(s);for(const s of t)e.has(s)||o.add(s);return o};function L(e,t){if(oe(e)!=="set"||e.size<=0)return;if(e.size===1){const s=[...e.values()][0];this.moduleMap.has(s)&&this.moduleMap.get(s).getDetails()}const o=this.getSelected;this.selectedModules.clear(),t==="replace"&&o.clear(),e.forEach(s=>{switch(t){case"add":o.add(s);break;case"delete":o.delete(s);break;case"toggle":o.has(s)?o.delete(s):o.add(s);break;case"replace":o.add(s);break}}),o.forEach(s=>this.selectedModules.add(s))}function mi(){this.visibleSelected.clear(),this.operationHandlers.clear(),this.getVisibleModuleMap.forEach(e=>{if(e.type==="rectangle"){const{x:t,y:o,id:s,width:l,height:i,rotation:n}=e;le(t,o,l,i,n).forEach(c=>{this.operationHandlers.add({id:s,type:"resize",data:{...c,r:this.viewport.scale}})})}this.selectedModules.has(e.id)&&this.visibleSelected.add(e.id)})}function xi(){const e="#1FB3FF",t="rgba(31,180,255,0.1)",o=document.createElement("div"),s=document.createElement("div"),l=document.createElement("canvas"),i=document.createElement("canvas"),{scrollBarX:n,scrollBarY:a}=wi();return i.setAttribute("editor-main-canvas",""),i.style.backgroundColor="#f0f0f0",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.style.pointerEvents="none",l.setAttribute("editor-selection-canvas",""),l.style.position="absolute",l.style.left="0",l.style.top="0",l.style.width="100%",l.style.height="100%",l.style.pointerEvents="none",o.setAttribute("editor-wrapper",""),o.style.userSelect="none",o.style.position="relative",o.style.scrollbarWidth="thin",o.style.scrollbarColor="#787878 transparent",o.style.overflow="hidden",o.style.width="100%",o.style.height="100%",s.setAttribute("editor-selection-box",""),s.style.pointerEvents="none",s.style.position="absolute",s.style.border="1px solid "+e,s.style.backgroundColor=t,o.append(i,l,n,a,s),{wrapper:o,selectionBox:s,selectionCanvas:l,mainCanvas:i,scrollBarX:n,scrollBarY:a}}const wi=()=>{const e=document.createElement("div"),t=document.createElement("div");return e.setAttribute("scroll-bar-x",""),t.setAttribute("scroll-bar-y",""),e.style.backgroundColor="#787878",t.style.backgroundColor="#787878",e.style.userSelect="none",t.style.userSelect="none",t.style.translate="none",t.style.translate="none",{scrollBarX:e,scrollBarY:t}},vi=(e,t)=>{e.style.width="50px",e.style.height="6px",e.style.position="absolute",e.style.bottom="0",e.style.left="0",t.style.width="6px",t.style.height="50px",t.style.position="absolute",t.style.right="0",t.style.top="0"},ne=(e,{x:t,y:o,height:s,width:l},i=!0)=>{e.style.transform=`translate(${t}px, ${o}px)`,e.style.width=l+"px",e.style.height=s+"px",e.style.display=i?"block":"none"},re=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.filter(o=>{const s=Object.keys(o).sort().map(l=>`${l}:${String(o[l])}`).join(";");return t.has(s)?!1:(t.add(s),!0)})},ae=(e,t)=>{let o=t;o.length>1e3&&(o=t.map(l=>({...l,x:Math.floor(l.x),y:Math.floor(l.y)})));const s=re(o);e.save(),s.forEach(({x:l,y:i,width:n,height:a,fillColor:c="",lineColor:d="",lineWidth:h=1,radius:u=0,opacity:p=100,gradient:m,rotation:g=0,dashLine:b=""})=>{const x=n/2,w=a/2;e.save(),e.translate(l,i),g>0&&e.rotate(g*Math.PI/180),p>0&&(e.fillStyle=c,e.globalAlpha=p/100),h>0&&(e.lineWidth=h,e.strokeStyle=d,e.lineJoin="round"),e.beginPath(),b&&e.setLineDash([3,5]),u>0?(e.moveTo(-x+u,-w),e.arcTo(x,-w,x,w,u),e.arcTo(x,w,-x,w,u),e.arcTo(-x,w,-x,-w,u),e.arcTo(-x,-w,x,-w,u)):e.rect(-x,-w,n,a),e.closePath(),p>0&&e.fill(),h>0&&e.stroke(),e.restore()})},Ci=(e,t)=>{const o=new Set,s=",";e.save(),t.forEach(a=>{const c=Object.values(a).join(s);o.add(c)});let l=NaN,i="";const n=new Path2D;o.forEach(a=>{const c=a.split(s),d=parseFloat(c[0]),h=parseFloat(c[1]),u=parseFloat(c[2]),p=parseFloat(c[3]),m=c[4],g=parseFloat(c[5]);g!==l&&(e.lineWidth=g,l=g),m!==i&&(e.fillStyle=m,i=m),n.moveTo(d,h),n.lineTo(u,p)}),e.stroke(n),e.restore()},Mi=({ctx:e,modules:t,frame:o})=>{const l=[{...o,x:o.cx,y:o.cy}],i=[],n=[];t.forEach(a=>{if(a.type==="rectangle"){const{x:c,y:d,width:h,height:u,enableFill:p,enableLine:m,opacity:g,lineWidth:b,fillColor:x,lineColor:w,rotation:v,gradient:F,radius:M,id:E}=a.getDetails();(p&&g>0||m)&&l.push({x:c,y:d,width:h,height:u,fillColor:x,opacity:g,lineWidth:b,lineColor:w,rotation:v,gradient:F,radius:M}),n.push({x:c+10,y:d+10,width:h,height:u,id:E.match(/\d+$/g)[0]})}if(a.type==="connector"){const c=t.get(a.start),d=t.get(a.end),h=c.getBoundingRect(),u=d.getBoundingRect();i.push({startX:h.centerX,startY:h.bottom,endX:u.centerX,endY:u.top,fillStyle:"#5491f8",lineWidth:1})}}),ae(e,l),Ci(e,i),Si(e,n)},Si=(e,t)=>{e.font="sans-serif",e.textBaseline="top",t.forEach(({id:o,x:s,y:l,width:i,height:n})=>{e.fillText(o,s-i/2+5,l-n/2+5,100)})},Ni=(e,t)=>{let o=t;o.length>1e3&&(o=t.map(l=>({...l,x:Math.floor(l.x),y:Math.floor(l.y)})));const s=re(o);e.save(),s.forEach(({x:l,y:i,r1:n,r2:a,fillColor:c="",lineColor:d="",lineWidth:h=1,opacity:u=100,gradient:p,rotation:m=0,dashLine:g=""})=>{e.save(),e.translate(l,i),m!==0&&e.rotate(m*Math.PI/180),u>0&&(e.fillStyle=c,e.globalAlpha=u/100),h>0&&(e.lineWidth=h,e.strokeStyle=d,e.lineJoin="round"),e.beginPath(),e.ellipse(0,0,n,a,0,0,Math.PI*2),g?e.setLineDash([3,5]):e.setLineDash([]),e.closePath(),u>0&&e.fill(),h>0&&e.stroke(),p&&(e.fillStyle=p,u>0&&e.fill()),e.restore()})};function ji(e){if(!e||e.size===0)return;const{selectionCTX:t,dpr:o,offset:s,worldRect:l,scale:i,mouseMovePoint:n}=this.viewport;this.selectedModules.size;const a=this.getModulesByIdSet(e),c=this.resizeHandleSize/2,d=[],h=[],u="#5491f8",p="#5491f8";a.forEach(m=>{const{x:g,y:b,width:x,height:w,rotation:v,lineWidth:F}=m.getDetails(),M=le(g,b,x,w,v);h.push(...M.map(E=>({...E,r1:c,r2:c,fillColor:u,lineColor:"#fff"}))),d.push({x:g,y:b,width:x,height:w,fillColor:u,lineColor:p,lineWidth:F,rotation:v,opacity:0,dashLine:"dash"})}),ae(t,d),Ni(t,h),this.viewport.enableCrossLine&&this.viewport.drawCrossLine&&bi({ctx:t,mousePoint:n,scale:i,dpr:o,offset:s})}const Fi=(e,t,o=.98)=>{const{width:s,height:l}=t,{width:i,height:n}=e,a=s/i,c=l/n,d=Math.min(a,c)*o,h=(s-i*d)/2-e.x*d,u=(l-n*d)/2-e.y*d;return{scale:d,offsetX:h,offsetY:u}},ki=(e="A4")=>{let t=0,o=0;const s=0,l=0;if(e==="A4"||e==="A4L"){const n=1.414142857;e==="A4L"?(o=1e3,t=n*o):(t=1e3,o=n*t)}else e==="photo1"&&(t=35,o=55);return{...H({x:s,y:l,width:t,height:o}),opacity:100,lineWidth:1,lineColor:"#000000",fillColor:"#fff"}};function ce(){const{viewport:e,hoveredModules:t}=this,o=this.getWorldPointByViewportPoint(e.mouseMovePoint.x,e.mouseMovePoint.y);t.clear(),this.getVisibleModuleMap.forEach(s=>{if(s.type==="rectangle"){const{x:l,y:i,width:n,height:a,rotation:c}=s;li(o,{x:l,y:i,width:n,height:a},c)&&t.add(s.id)}})}function Ei(e){const{shiftKey:t,clientY:o,target:s,clientX:l,metaKey:i,ctrlKey:n}=e;if(s!==this.viewport.wrapper)return;const a=n||i||t,c=l-this.viewport.rect.x,d=o-this.viewport.rect.y;if(this.viewport.mouseDownPoint.x=c,this.viewport.mouseDownPoint.y=d,this.viewport.mouseMovePoint.x=c,this.viewport.mouseMovePoint.y=d,ce.call(this),e.preventDefault(),this.viewport.spaceKeyDown)return this.manipulationStatus="panning";const h=[...this.hoveredModules][this.hoveredModules.size-1];if(!h)return a||this.action.dispatch("selection-clear"),this.selectedShadow=this.getSelected,this.manipulationStatus="selecting";this.manipulationStatus="dragging";const u=this.getSelected,p=u.has(h);u.size===0||!p&&!a?(this.action.dispatch("modify-selection",{mode:"replace",idSet:new Set([h])}),this.draggingModules=new Set([h])):a?(this.draggingModules=new Set(u),p?(console.log("isSelected",p),this._deselection=h,this.draggingModules.add(h)):this.action.dispatch("modify-selection",{mode:"add",idSet:new Set([h])}),this.draggingModules.add(h)):this.draggingModules=new Set(u)}function $i(e){const{draggingModules:t,manipulationStatus:o,moduleMap:s,_selectingModules:l,selectedShadow:i,viewport:n}=this,a=e.clientX-n.rect.x,c=e.clientY-n.rect.y,d=e.ctrlKey||e.metaKey||e.shiftKey;switch(n.mouseMovePoint.x=a,n.mouseMovePoint.y=c,o){case"selecting":break;case"panning":break;case"dragging":{const h=(n.mouseMovePoint.x-n.mouseDownPoint.x)*n.dpr/n.scale,u=(n.mouseMovePoint.y-n.mouseDownPoint.y)*n.dpr/n.scale;if(!(h===0&&u===0))t.forEach(m=>{s.get(m).x-=h,s.get(m).y-=u}),this.action.dispatch("selection-move",{direction:"module-move-shift",delta:{x:h,y:u}});else{const m=[...this.hoveredModules][this.hoveredModules.size-1];m&&d&&m===this._deselection&&this.action.dispatch("modify-selection",{mode:"toggle",idSet:new Set([m])})}}break;case"resizing":break;case"rotating":break;case"mousedown":console.log(this.draggingModules),this.action.dispatch("selection-clear");break;case"static":e.ctrlKey||e.metaKey||e.shiftKey?this.toggleSelected(t):this.replaceSelected(t);break}t.clear(),i.clear(),l.clear(),this.manipulationStatus="static",this._deselection=null,ne(n.selectionBox,{x:0,y:0,width:0,height:0},!1)}function Li(e){if(!(this.manipulationStatus==="panning"||this.manipulationStatus==="selecting")&&e.code==="Space"){this.viewport.spaceKeyDown=!0,this.viewport.wrapper.style.cursor="grabbing",e.preventDefault();return}}function Ti(e){e.code==="Space"&&(this.viewport.spaceKeyDown=!1,this.viewport.wrapper.style.cursor="default")}function Pi(e){if(e.target!==this.viewport.wrapper||(e.preventDefault(),e.stopPropagation(),this.manipulationStatus!=="static"))return;const{zooming:t,panning:o,scrolling:s,zoomFactor:l,translateX:i,translateY:n}=Di(e);this.viewport.zooming=t,t?(console.log(l),this.action.dispatch("world-zoom",{zoomFactor:l,physicalPoint:this.viewport.mouseMovePoint})):(o||s)&&this.action.dispatch("world-shift",{x:i,y:n}),this.updateWorldRect()}const Di=(()=>{let e;const s=[];let l=!1,i=!1,n=!1,a=0,c=0,d=0,h=!1;const u=.01,p=.1;return m=>{const{deltaX:g,deltaY:b,altKey:x}=m;if(e&&clearTimeout(e),h?s.length=0:s.push(m),c=0,d=0,l=!1,n=!1,i=!1,x&&(l=!0),s.length>=3){const w=s.every(M=>B(M.deltaX)),v=s.every(M=>V(M.deltaY)),F=s.every(M=>Math.abs(M.deltaY)>4);w&&v&&!F&&(h=!0,console.log("touchpadZoomingLock"))}return h?(a=b>0?-.01:u,l=!0):Math.abs(g)>=40&&B(b)?x?a=g<0?p:-.1:(n=!0,c=-g):B(g)&&V(b)&&Math.abs(b)>4?x?a=b<0?u:-.01:(n=!0,d=-b):q(g)&&q(b)&&(x?a=(Math.abs(g)>Math.abs(b)?g:b)<0?u:-.01:(i=!0,c=-g,d=-b)),l&&x&&(a=a<0?-.1:p),e=setTimeout(()=>{h=!1,l=!1,i=!1,n=!1,a=0,c=0,d=0,s.length=0},200),{zooming:l,panning:i,scrolling:n,zoomFactor:a,translateX:c,translateY:d}}})();function q(e){return!V(e)}function V(e){return Math.abs(e)%1!==0}function Ai(e){const{action:t,draggingModules:o,moduleMap:s,viewport:l,selectedShadow:i,_selectingModules:n}=this;switch(l.mouseMovePoint.x=e.clientX-l.rect.x,l.mouseMovePoint.y=e.clientY-l.rect.y,l.drawCrossLine=!1,t.dispatch("world-mouse-move"),this.manipulationStatus){case"selecting":{l.wrapper.setPointerCapture(e.pointerId);const a=k(l.mouseDownPoint,l.mouseMovePoint),c=this.getWorldPointByViewportPoint(a.x,a.y),d=this.getWorldPointByViewportPoint(a.right,a.bottom),h=k(c,d),u=new Set,p=e.ctrlKey||e.metaKey||e.shiftKey;this.getVisibleModuleMap.forEach(b=>{if(b.type==="rectangle"){const x=b.getBoundingRect();si(x,h)&&u.add(b.id)}});const m=!gi(n,u);if(ne(l.selectionBox,a),!m)return;this._selectingModules=u;const g=yi(i,u);if(p)t.dispatch("modify-selection",{mode:"replace",idSet:g});else{if(u.size===0&&i.size===0)return t.dispatch("selection-clear");const b=new Set([...i,...u]);t.dispatch("modify-selection",{mode:"replace",idSet:b})}}break;case"panning":t.dispatch("world-shift",{x:e.movementX,y:e.movementY});break;case"dragging":{l.wrapper.setPointerCapture(e.pointerId);const a=e.movementX*l.dpr/l.scale,c=e.movementY*l.dpr/l.scale;o.forEach(d=>{s.get(d).move(a,c)}),this.action.dispatch("visible-module-update")}break;case"resizing":break;case"rotating":break;case"mousedown":(Math.abs(l.mouseMovePoint.x-l.mouseDownPoint.x)>1||Math.abs(l.mouseMovePoint.y-l.mouseDownPoint.y)>1)&&(o.size>0?this.manipulationStatus="dragging":this.manipulationStatus="selecting");break;case"static":ce.call(this),l.wrapper.releasePointerCapture(e.pointerId),l.drawCrossLine=l.drawCrossLineDefault;break}}function Ri(e){if(e.preventDefault(),e.stopPropagation(),e.ctrlKey)return!1;const t=[...this.hoveredModules][this.hoveredModules.size-1],o=this.getSelected,s={...this.viewport.mouseMovePoint};let l=new Set;t&&(o.has(t)?l=o:l.add(t)),this.action.dispatch("context-menu",{idSet:l,position:s,copiedItems:this.copiedItems.length>0})}function zi(){const{wrapper:e,mainCanvas:t,selectionCanvas:o,selectionBox:s,scrollBarX:l,scrollBarY:i}=xi(),n=o.getContext("2d"),a=t.getContext("2d"),c=new AbortController,d=new ResizeObserver(ii(()=>{this.action.dispatch("viewport-resize")},200)),{signal:h}=c,u={x:0,y:0},p={x:0,y:0},m=k(u,p),g=k(u,p),b=k(u,p);return window.addEventListener("mousedown",Ei.bind(this),{signal:h}),window.addEventListener("mouseup",$i.bind(this),{signal:h}),window.addEventListener("keydown",Li.bind(this),{signal:h}),window.addEventListener("keyup",Ti.bind(this),{signal:h}),window.addEventListener("wheel",Pi.bind(this),{signal:h,passive:!1}),e.addEventListener("pointermove",Ai.bind(this),{signal:h}),e.addEventListener("contextmenu",Ri.bind(this),{signal:h}),{drawCrossLine:!1,drawCrossLineDefault:!1,enableCrossLine:!1,initialized:!1,scale:1,spaceKeyDown:!1,zooming:!1,dpr:this.config.dpr,frame:ki("A4"),offset:{x:0,y:0},viewportRect:g,worldRect:b,mouseDownPoint:u,mouseMovePoint:p,rect:m,wrapper:e,mainCanvas:t,selectionCanvas:o,selectionCTX:n,mainCTX:a,scrollBarX:l,scrollBarY:i,selectionBox:s,resizeObserver:d,eventsController:c}}function Bi(){this.viewport&&(this.viewport.resizeObserver.disconnect(),this.viewport.eventsController.abort(),this.viewport.wrapper.style.width="100%",this.viewport.wrapper.style.height="100%",this.viewport.wrapper.remove(),this.viewport=null)}const J=(e,t,o,{x:s,y:l})=>{const i=[o,0,0,o,s*t,l*t];e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width*2,e.canvas.height*2),e.setTransform(...i)},de=e=>new Set(e.map(t=>t.id));function he(e=!1){if(this.history.current===this.history.tail)return!1;this.history.forward();const{type:t,payload:o}=this.history.current.data,{selectedModules:s}=o;switch(t){case"history-init":break;case"history-add":case"history-paste":case"history-duplicate":this.batchAdd(this.batchCreate(o.modules));break;case"history-modify":break;case"history-move":this.batchMove(o.selectedModules,{x:o.delta.x,y:o.delta.y});break;case"history-reorder":break;case"history-group":break;case"history-ungroup":break;case"history-composite":break;case"history-delete":this.batchDelete(de(o.modules));break}return e||(this.replaceSelected(s),this.action.dispatch("editor-selection-update")),this.history.current}function ue(e=!1){if(this.history.current===this.history.head)return!1;const{type:t,payload:o}=this.history.current.data;let s=null;switch(t){case"history-init":break;case"history-add":case"history-paste":case"history-duplicate":this.batchDelete(de(o.modules));break;case"history-modify":break;case"history-move":this.batchMove(o.selectedModules,{x:-o.delta.x,y:-o.delta.y});break;case"history-reorder":break;case"history-group":break;case"history-ungroup":break;case"history-composite":break;case"history-delete":s=o.modules,this.batchAdd(this.batchCreate(s));break}if(this.history.back(),!e){const l=this.history.current.data.payload.selectedModules;this.replaceSelected(l),this.action.dispatch("editor-selection-update")}return this.history.current}function Ii(e){var o,s;const t=this.history.compareToCurrentPosition(e);if(!(!t||t==="equal")&&(t==="front"||t==="behind")){let i;for(;t==="front"?i=ue.call(this,!0):t==="behind"&&(i=he.call(this,!0)),i!==e;);const{selectedModules:n}=e.data.payload;this.replaceSelected(n),(s=(o=this.events).onHistoryUpdated)==null||s.call(o,this.history)}}function Oi(){const{container:e,viewport:t,action:o}=this,s=o.dispatch.bind(o),l=o.on.bind(o);e.appendChild(t.wrapper),t.resizeObserver.observe(e),l("viewport-resize",()=>{this.updateViewport(),this.initialized?s("world-update"):s("editor-initialized")}),l("editor-initialized",()=>{var i,n;s("world-update"),this.initialized=!0,this.fitFrame(),(n=(i=this.events).onInitialized)==null||n.call(i)}),l("editor-module-map-update",i=>{this.updateVisibleModuleMap(),s("visible-module-update",!0),s("editor-selection-update"),this.history.add(i)}),l("editor-selection-update",()=>{var i,n;mi.call(this),(n=(i=this.events).onSelectionUpdated)==null||n.call(i,this.selectedModules,this.getSelectedPropsIfUnique()),s("visible-selected-update")}),l("world-mouse-move",()=>{var n,a;const i=this.getWorldPointByViewportPoint(this.viewport.mouseMovePoint.x,this.viewport.mouseMovePoint.y);(a=(n=this.events).onWorldMouseMove)==null||a.call(n,i)}),l("world-update",()=>{var i,n;this.updateWorldRect(),this.updateVisibleModuleMap(),(n=(i=this.events).onViewportUpdated)==null||n.call(i,this.viewport.worldRect),s("visible-module-update")}),l("world-zoom",i=>{if(i==="fit")this.fitFrame(),s("world-update");else{const n=this.zoomAtPoint(i.physicalPoint,i.zoomFactor);if(n){const{scale:a,offset:c}=n;this.viewport.scale=a,this.viewport.offset.x=c.x,this.viewport.offset.y=c.y,s("world-update")}}}),l("world-shift",i=>{const{x:n,y:a}=i;this.viewport.offset.x+=n,this.viewport.offset.y+=a,s("world-update")}),l("select-all",()=>{this.selectAll(),s("editor-selection-update")}),l("selection-clear",()=>{this.selectedModules.clear(),s("editor-selection-update")}),l("modify-selection",i=>{const{mode:n,idSet:a}=i;this.modifySelected(a,n),s("editor-selection-update")}),l("selection-delete",()=>{const i=this.getSelected,n=this.batchDelete(i);this.selectedModules.clear(),s("editor-module-map-update",{type:"history-delete",payload:{modules:n,selectedModules:i}})}),l("selection-copy",()=>{this.copiedItems=this.batchCopy(this.getSelected,!0),this.updateCopiedItemsDelta()}),l("selection-paste",i=>{if(this.copiedItems.length===0)return;let n;if(i){const{x:c,y:d}=this.getWorldPointByViewportPoint(i.x,i.y),h=this.copiedItems.reduce((g,b)=>b.x<g.x&&b.y<g.y?b:g),u=c-h.x,p=d-h.y,m=this.copiedItems.map(g=>({...g,x:g.x+u,y:g.y+p}));n=this.batchCreate(m)}else n=this.batchCreate(this.copiedItems);const a=new Set(n.keys());this.batchAdd(n),this.replaceSelected(a),this.updateCopiedItemsDelta(),s("editor-module-map-update",{type:"history-paste",payload:{modules:[...n.values()].map(c=>c.getDetails()),selectedModules:a}})}),l("selection-duplicate",()=>{const i=this.batchCopy(this.selectedModules,!0);i.forEach(d=>{d.x+=this.CopyDeltaX,d.y+=this.CopyDeltaY});const n=this.batchCreate(i),a=new Set(n.keys());this.batchAdd(n),this.replaceSelected(a);const c=[...n.values()].map(d=>d.getDetails());s("editor-module-map-update",{type:"history-duplicate",payload:{modules:c,selectedModules:a}})}),l("selection-move",({direction:i,delta:n={x:0,y:0}})=>{if(this.getSelected.size===0)return;const a=5,c=this.getSelected;switch(i){case"module-move-down":n.y=a;break;case"module-move-up":n.y=-5;break;case"module-move-left":n.x=-5;break;case"module-move-right":n.x=a;break}this.batchMove(this.selectedModules,n),s("editor-selection-update"),s("visible-module-update"),this.history.add({type:"history-move",payload:{delta:n,selectedModules:c}})}),l("module-add",i=>{const n=this.batchAdd(this.batchCreate(i)),a=new Set(n.keys());this.batchAdd(n),this.replaceSelected(a);const c=[...n.values()].map(d=>d.getDetails());s("editor-module-map-update",{type:"history-add",payload:{modules:c,selectedModules:a}})}),l("visible-module-update",(i=!1)=>{i||s("visible-selected-update"),J(this.viewport.mainCTX,this.viewport.dpr,this.viewport.scale,this.viewport.offset),this.renderModules()}),l("visible-selected-update",()=>{J(this.viewport.selectionCTX,this.viewport.dpr,this.viewport.scale,this.viewport.offset),this.renderSelections(this.getVisibleSelected)}),l("history-undo",()=>{var i,n;ue.call(this),this.updateVisibleModuleMap(),s("visible-module-update"),(n=(i=this.events).onHistoryUpdated)==null||n.call(i,this.history)}),l("history-redo",()=>{var i,n;he.call(this),this.updateVisibleModuleMap(),s("visible-module-update"),(n=(i=this.events).onHistoryUpdated)==null||n.call(i,this.history)}),l("history-pick",i=>{var n,a;Ii.call(this,i),this.updateVisibleModuleMap(),s("visible-module-update"),(a=(n=this.events).onHistoryUpdated)==null||a.call(n,this.history)}),l("context-menu",({idSet:i,position:n,copiedItems:a})=>{var c,d;(d=(c=this.events).onContextMenu)==null||d.call(c,i,n,a)})}class Vi{constructor({container:t,data:o,events:s={},config:l={dpr:2}}){y(this,"id");y(this,"config");y(this,"moduleCounter",0);y(this,"moduleMap");y(this,"visibleModuleMap");y(this,"action");y(this,"container");y(this,"events",{});y(this,"history");y(this,"viewport");y(this,"selectedModules",new Set);y(this,"visibleSelected",new Set);y(this,"operationHandlers",new Set);y(this,"resizeHandleSize",10);y(this,"copiedItems",[]);y(this,"hoveredModules",new Set);y(this,"draggingModules",new Set);y(this,"_selectingModules",new Set);y(this,"_deselection",null);y(this,"selectedShadow",new Set);y(this,"manipulationStatus","static");y(this,"CopyDeltaX",50);y(this,"CopyDeltaY",100);y(this,"initialized",!1);this.visibleModuleMap=new Map,this.id=o.id,this.config=l,this.events=s,this.action=new ei,this.container=t,this.history=new Ql(this),this.viewport=zi.call(this),this.moduleMap=o.modules.reduce((i,n)=>(i.set(n.id,n),i),new Map),this.init()}init(){Oi.call(this)}get createModuleId(){return this.id+"-"+ ++this.moduleCounter}batchCreate(t){return ci.call(this,t)}batchAdd(t){return di.call(this,t)}batchCopy(t,o=!1,s){return hi.call(this,t,o,s)}batchDelete(t){return ui.call(this,t)}batchMove(t,o){pi.call(this,t,o)}batchModify(t,o,s){fi.call(this,t,o,s)}getModulesByLayerIndex(){}getModulesByIdSet(t){const o=new Map;return t.forEach(s=>{const l=this.moduleMap.get(s);l&&o.set(s,l)}),o}getModuleList(){return[...Object.values(this.moduleMap)]}updateVisibleModuleMap(){this.visibleModuleMap.clear(),this.moduleMap.forEach(t=>{const o=t.getBoundingRect();oi(o,this.viewport.worldRect)&&this.visibleModuleMap.set(t.id,t)})}get getVisibleModuleMap(){return new Map(this.visibleModuleMap)}execute(t,o=null){this.action.execute(t,o)}get getVisibleSelected(){return new Set(this.visibleSelected)}get getSelected(){return new Set(this.selectedModules)}modifySelected(t,o){L.call(this,t,o)}addSelected(t){L.call(this,t,"add")}deleteSelected(t){L.call(this,t,"delete")}toggleSelected(t){L.call(this,t,"toggle")}replaceSelected(t){L.call(this,t,"replace")}selectAll(){this.selectedModules.clear(),this.moduleMap.forEach(t=>{this.selectedModules.add(t.id)})}updateCopiedItemsDelta(){this.copiedItems.forEach(t=>{t.x+=this.CopyDeltaX,t.y+=this.CopyDeltaY})}getSelectedPropsIfUnique(){if(this.selectedModules.size===1){const t=[...this.selectedModules.values()][0];return this.moduleMap.get(t).getDetails()}return null}renderModules(){if(this.visibleModuleMap.size===0)return;requestAnimationFrame(()=>{Mi({ctx:this.viewport.mainCTX,frame:this.viewport.frame,modules:this.visibleModuleMap})})}renderSelections(t){requestAnimationFrame(()=>{ji.call(this,t)})}updateWorldRect(){const{width:t,height:o}=this.viewport.viewportRect,s=this.getWorldPointByViewportPoint(0,0),l=this.getWorldPointByViewportPoint(t,o);this.viewport.worldRect=k(s,l)}zoomAtPoint(t,o,s=!1){const{offset:l,scale:i,dpr:n}=this.viewport,a=.1*n,c=5*n;let d=i+o;if(s&&(d=o),d<a||d>c)return!1;const h=Math.max(a,Math.min(c,d)),u=h/i,p=this.getWorldPointByViewportPoint(t.x,t.y),m=p.x-(p.x-l.x)*u,g=p.y-(p.y-l.y)*u;return console.log({scale:h,offset:{x:m,y:g}}),{scale:h,offset:{x:m,y:g}}}zoomTo(t){console.log(t),t==="fit"?this.fitFrame():this.zoomAtPoint({x:this.viewport.rect.width/2,y:this.viewport.viewportRect.height/2},t,!0)}setTranslateViewport(t,o){this.viewport.offset.x=0,this.viewport.offset.y=0,this.translateViewport(t,o)}translateViewport(t,o){this.viewport.offset.x+=t,this.viewport.offset.y+=o}updateScrollBar(){const{scrollBarX:t,scrollBarY:o}=this.viewport;vi(t,o)}updateViewport(){const{dpr:t,mainCanvas:o,selectionCanvas:s}=this.viewport,l=this.container.getBoundingClientRect().toJSON(),{x:i,y:n,width:a,height:c}=l,d=a*t,h=c*t;this.viewport.rect={...l,cx:i+a/2,cy:n+c/2},this.viewport.viewportRect=k({x:0,y:0},{x:d,y:h}),o.width=s.width=d,o.height=s.height=h}getWorldPointByViewportPoint(t,o){const{dpr:s,offset:l,scale:i}=this.viewport;return ie(i,l.x*s,l.y*s,t*s,o*s)}fitFrame(){const{frame:t,viewportRect:o,dpr:s}=this.viewport,{scale:l,offsetX:i,offsetY:n}=Fi(t,o,.95);this.viewport.scale=l,this.viewport.offset.x=i/s,this.viewport.offset.y=n/s}destroy(){Bi.call(this),this.action.destroy(),this.history.destroy(),this.moduleMap.clear()}}const S=f.createContext({focused:!1,historyArray:[],historyCurrent:0,selectedModules:[],selectedProps:{},editorRef:{},applyHistoryNode:()=>{},executeAction:()=>{},viewport:{width:0,height:0,offsetX:0,offsetY:0,scale:1,dx:0,dy:0,status:""}}),Ui=()=>{const{executeAction:e,focused:t}=f.useContext(S),o=s=>{let l=null;const{key:i,ctrlKey:n,metaKey:a,shiftKey:c}=s,h={ArrowUp:"module-move-up",ArrowDown:"module-move-down",ArrowLeft:"module-move-left",ArrowRight:"module-move-right"}[i];i==="a"&&(n||a)&&(l="select-all"),i==="c"&&(n||a)&&!c&&(l="selection-copy"),i==="v"&&(n||a)&&(l="selection-paste"),i==="d"&&(n||a)&&(l="selection-duplicate"),(i==="Delete"||i==="Backspace")&&(l="selection-delete"),i==="Escape"&&(l="selection-clear"),i==="z"&&(n||a)&&(l="history-undo"),i==="z"&&c&&(n||a)&&(l="history-redo"),h&&(l="selection-move"),l&&(h?e(l,{direction:h}):e(l),s.stopPropagation(),s.preventDefault())};return f.useEffect(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}),[t]),null},Xi=[{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50}],_i=()=>{const{editorRef:e}=f.useContext(S);return f.useEffect(()=>{e.current&&console.log("editorRef.current updated:",e.current)},[e]),r.jsx("div",{className:"flex flex-wrap space-x-2 space-y-2",children:Xi.map((t,o)=>r.jsx("div",{className:"shrink-0 select-none cursor-move",style:{width:t.width,height:t.height,border:"1px solid #dfdfdf"},onMouseEnter:()=>{}},o))})},Hi=({className:e=""})=>{const[t,o]=f.useState(300),s=f.useRef(!1),l=f.useRef(null),i=f.useCallback(c=>{c.preventDefault(),s.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[]),n=f.useCallback(c=>{if(!s.current)return;const d=window.innerWidth*.9,h=Math.min(Math.max(0,c.clientX),d);c.stopPropagation(),o(h)},[]),a=f.useCallback(c=>{s.current=!1,document.body.style.cursor="default",document.body.style.userSelect="",c.stopPropagation()},[]);return f.useEffect(()=>(window.addEventListener("mousemove",n),window.addEventListener("mouseup",a),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a)}),[n,a]),r.jsxs("div",{ref:l,style:{width:`${t}px`},className:"relative h-full flex-shrink-0 border-r border-gray-200",children:[r.jsxs("div",{className:`h-auto p-6 bg-white overflow-hidden ${e}`,children:[r.jsx("span",{children:"Module List"}),r.jsx(_i,{})]}),r.jsx("div",{className:"absolute z-10 top-0 -right-1 w-2 h-full bg-transparent hover:bg-gray-200 cursor-col-resize transition-colors",onMouseDown:i})]})},Q=e=>(e*100).toFixed(2)+"%",Wi=e=>{const t=e.replace("%","").trim(),o=Number(t);return isNaN(o)?!1:Number(o.toFixed(2))},Yi=({scale:e,onChange:t})=>{const o=[{label:"400%",value:4},{label:"300%",value:3},{label:"200%",value:2},{label:"150%",value:1.5},{label:"125%",value:1.25},{label:"100%",value:1},{label:"75%",value:.75},{label:"50%",value:.5},{label:"25%",value:.25},{label:"Fit window",value:"fit"}],[s,l]=f.useState(Q(1)),[i,n]=f.useState(!1),a=f.useRef(null);f.useEffect(()=>{const d=Q(e);a.current&&(a.current.value=d),l(d)},[e]);const c=d=>{if(d.key==="Enter"){const h=Wi(d.target.value);h!==!1&&t(h),a.current.blur()}d.stopPropagation()};return r.jsxs("div",{className:"w-17 h-5 ml-2 flex justify-start items-center relative  focus:ring-blue-500 focus:ring-1",children:[r.jsx("input",{type:"text",ref:a,onChange:void 0,defaultValue:s,onKeyDown:c,className:"w-20 h-5 text-sm bg-gray-100 text-center overflow-hidden ",placeholder:"Enter zoom %"}),r.jsx("button",{onClick:()=>n(!i),className:"text-gray-800 flex trasition items-center cursor-pointer",children:i?r.jsx(Ne,{className:"w-5 h-5"}):r.jsx(je,{className:"w-5 h-5"})}),i&&r.jsx("div",{className:"fixed w-full h-full",onClick:()=>{n(!1)}}),i&&r.jsx("div",{className:"absolute w-20 cursor-pointer py-2 left-0 bottom-5 bg-white shadow-lg max-h-40v overflow-y-auto z-10",children:o.map(({label:d,value:h})=>r.jsx("div",{onClick:()=>{n(!1),t(h)},className:"text-sm align-middle p-1 text-center hover:bg-blue-500 hover:text-white transition",children:h==="fit"?d:`${h*100}%`},h))})]})},Ki=({className:e="",worldPoint:t})=>{const{viewport:o,executeAction:s}=f.useContext(S);return o?r.jsx("footer",{className:e+"w-full h-8 flex justify-between pr-1 items-center border-t border-gray-200",children:o&&r.jsxs(r.Fragment,{children:[r.jsx(Yi,{scale:o.scale,onChange:l=>{s("world-zoom",l)}},o.scale),r.jsx("div",{className:"text-xs line-clamp-1",children:`dx:${t.x.toFixed(2)} dx:${t.y.toFixed(2)}`})]})}):null},I=28,Gi=({data:e,selected:t})=>{const o=f.useRef(null),s=f.useRef(null),[l,i]=f.useState(0),[n,a]=f.useState([0,10]),{executeAction:c}=f.useContext(S);f.useEffect(()=>{},[t]);const d=()=>{if(!o.current)return;const u=o.current.scrollTop,p=u<l,m=Math.round(u/I),g=m+10;if(p){if(n[0]>=e.length-1)return}else if(n[1]>=e.length-1)return;i(u),a([m,g])},h=[];for(let u=n[0];u<n[1];u++){const p=e[u];p&&h.push(r.jsx("div",{ref:t!=null&&t.includes(p.id)?s:null,style:{height:I},className:t!=null&&t.includes(p.id)?"bg-gray-400 text-white":"",onClick:()=>{c("modify-selection",{mode:"replace",idSet:new Set([p.id])})},id:`layer-module-${p.id}`,children:p.type},p.id))}return r.jsxs("div",{className:"p-2",children:[r.jsx("h1",{className:"bg-gray-400 text-white px-2",children:r.jsx("span",{children:"Layer"})}),r.jsx("div",{className:"p-2 relative overflow-hidden",children:r.jsxs("div",{ref:o,onScroll:d,className:"relative scrollbar-custom overflow-x-hidden overflow-y-auto p-2 border h-30 border-gray-200 select-none",children:[r.jsx("div",{className:"absolute w-full top-0 left-0",style:{height:e.length*I}}),r.jsx("div",{className:"w-full sticky top-0 left-0",children:h})]})})]})},pe=({menu:e})=>{const{t}=P(),[o,s]=f.useState(!1),{executeAction:l}=f.useContext(S),i=()=>{console.log(e.id),!(e.children||o)&&(l(e.id),s(!1))},n=e.children&&e.children.length>0;return r.jsxs("div",{className:"relative h-8 hover:bg-gray-200 min-w-50",onClick:()=>i(),onMouseOver:a=>{s(!0),a.preventDefault()},onMouseLeave:()=>{s(!1)},children:[r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center whitespace-nowrap",children:[r.jsx("span",{children:t(e.id+".label")}),n&&r.jsx(Fe,{size:18})]}),n&&o&&r.jsx("div",{className:"absolute bg-white z-30 left-full top-0 w-auto border border-gray-200 box-border",children:e.children.map(a=>r.jsx(pe,{menu:a},a.id))})]})},Zi=()=>{const[e,t]=f.useState(!1),[o,s]=f.useState(null),{t:l}=P(),i=f.useRef(null),n=te(c=>c.menu.actions),a=f.useMemo(()=>qi(n),[n]);return f.useEffect(()=>{const c=d=>{i.current.contains(d.target)||(t(!1),s(null))};return window.addEventListener("click",c),()=>{window.removeEventListener("click",c)}}),r.jsx("div",{className:"h-8 text-sm select-none border-gray-200 box-border",children:r.jsx("div",{ref:i,className:"pl-2 h-full inline-flex",children:a.map(c=>{var d;return r.jsxs("div",{className:"relative h-full",children:[r.jsx("div",{className:`h-full inline-flex items-center px-4 ${c.id===o?"bg-gray-200":""}`,onMouseEnter:()=>e&&s(c.id),onClick:()=>{o!==c.id?(t(!0),s(c.id)):(s(null),t(!1))},title:l(c.id+".tooltip"),children:r.jsx("span",{children:l(c.id+".label")})}),e&&c.id===o&&c.children.length>0&&r.jsx("div",{className:"absolute z-20 bg-white border border-gray-200",children:(d=c.children)==null?void 0:d.map(h=>r.jsx(pe,{menu:h},h.id))})]},c.id)})})})};function qi(e){const t=new Map;Object.values(e).forEach(s=>{t.set(s.id,{...s,children:[]})});const o=[];return t.forEach(s=>{const l=t.get(s.parent);l?l.children.push(s):o.push(s)}),o}const A={strokeWidth:"2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},R="#9b9a9a",Ji=({size:e=24,...t})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",...A,...t,children:[r.jsx("path",{fill:R,d:"M12,10.87l-9.06,5.67,9.06,5.67,9.06-5.67-9.06-5.67Z"}),r.jsx("path",{fill:"#fff",d:"M9.57,7.84c-2.21,1.38-4.42,2.76-6.64,4.15,3.02,1.89,6.04,3.78,9.06,5.67l9.06-5.67c-2.24-1.4-4.48-2.8-6.72-4.2"}),r.jsx("path",{d:"M11.96,1.8c.01,2.22.04,6.67.04,6.67M11.96,1.8c-1.87,1.12-3.75,2.25-5.62,3.37M12,1.8c2.09,1.3,3.4,2.13,5.55,3.47"})]}),Qi=({size:e=24,...t})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",...A,...t,children:[r.jsx("path",{fill:"#fff",d:"M14.43,16.16c2.21-1.38,4.42-2.76,6.64-4.15-3.02-1.89-6.04-3.78-9.06-5.67L2.94,12.02c2.24,1.4,4.48,2.8,6.72,4.2"}),r.jsx("path",{fill:"#fff",d:"M12.04,22.2c0-2.26-.02-4.52-.03-6.77M12.04,22.2c1.87-1.12,3.75-2.25,5.62-3.37M12,22.2c-2.09-1.3-3.4-2.13-5.55-3.47"}),r.jsx("path",{fill:R,d:"M12,13.13l9.06-5.67L12,1.8,2.94,7.46l9.06,5.67Z"})]}),en=({size:e=24,...t})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",...A,...t,children:[r.jsx("path",{d:"M12,10.8l-9.65,6.03,9.65,6.03,9.65-6.03-9.65-6.03Z"}),r.jsx("path",{fill:"#fff",d:"M12,5.99L2.35,12.02l9.65,6.03,9.65-6.03-9.65-6.03Z"}),r.jsx("path",{fill:R,d:"M12,1.14L2.35,7.17l9.65,6.03,9.65-6.03L12,1.14Z"})]}),tn=({size:e=24,...t})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",...A,...t,children:[r.jsx("path",{fill:R,d:"M12,10.8l-9.65,6.03,9.65,6.03,9.65-6.03-9.65-6.03Z"}),r.jsx("path",{fill:"#fff",d:"M12,5.99L2.35,12.02l9.65,6.03,9.65-6.03-9.65-6.03Z"}),r.jsx("path",{fill:"#fff",d:"M12,1.14L2.35,7.17l9.65,6.03,9.65-6.03L12,1.14Z"})]}),on=({iconName:e,size:t})=>{switch(e){case"save":return r.jsx(Re,{size:t});case"undo":return r.jsx(Ae,{size:t});case"redo":return r.jsx(De,{size:t});case"trash":return r.jsx(Pe,{size:t});case"cross":return r.jsx(Te,{size:t});case"group":return r.jsx(Le,{size:t});case"ungroup":return r.jsx($e,{size:t});case"lock":return r.jsx(Ee,{size:t});case"unlock":return r.jsx(ke,{size:t});default:return null}},T=20,D="text-black",sn=()=>{const e=te(o=>o.toolbar.actions),{executeAction:t}=f.useContext(S);return r.jsx("div",{className:"border-b border-gray-200 box-border",children:r.jsx("div",{className:"h-10 inline-flex pl-4 items-center",children:Object.values(e).map(o=>{const{id:s,icon:l,disabled:i,divide:n}=o;let a;switch(s){case"layerUp":a=r.jsx(Ji,{size:T,className:D});break;case"layerDown":a=r.jsx(Qi,{size:T,className:D});break;case"layerTop":a=r.jsx(en,{size:T,className:D});break;case"layerBottom":a=r.jsx(tn,{size:T,className:D});break;default:a=r.jsx(on,{size:T,iconName:l});break}const{tooltip:c}=ze(s,{returnObjects:!0});return r.jsxs(f.Fragment,{children:[r.jsx("button",{type:"button",disabled:i,title:c,onClick:()=>{s==="undo"||s==="redo"?t("history-"+s):s==="delete"&&t("selection-"+s)},className:"relative ml-1 rounded-sm mr-1 flex items-center cursor-pointer justify-center w-6 h-6 opacity-50   hover:bg-gray-200  hover:opacity-100 disabled:text-gray-200 disabled:cursor-default",children:a}),n&&r.jsx("div",{className:"w-[1px] h-4 bg-gray-400 mx-2"})]},s)})})})},ln=()=>r.jsxs("header",{children:[r.jsx(Zi,{}),r.jsx(sn,{})]}),nn=()=>{const{historyArray:e,historyCurrent:t,applyHistoryNode:o}=f.useContext(S),{t:s}=P(),l=f.useRef(null);return f.useEffect(()=>{if(l.current)return()=>{}},[e,t]),r.jsxs("div",{className:"p-2",children:[r.jsx("h1",{className:"bg-gray-600 text-white px-2",children:r.jsx("span",{children:"History"})}),r.jsx("div",{className:"border h-50 border-gray-200 overflow-x-auto scrollbar-custom overflow-y-auto",children:r.jsx("div",{className:"flex flex-col m-2 border border-gray-200 min-h-40 bg-gray-100",children:e.map((i,n)=>{const a=i.id===t,c="history."+i.data.type,{label:d,tooltip:h}=s(c,{returnObjects:!0});return r.jsx("div",{title:h,ref:a?l:null,onClick:()=>{a||o(i)},className:` px-2 py-1 cursor-pointer text-xs hover:bg-gray-400 hover:text-white ${a?"bg-gray-400 text-white":""}`,children:r.jsx("span",{children:d})},n)})})})]})},rn=()=>{const{selectedProps:e}=f.useContext(S);return f.useEffect(()=>{},[e]),r.jsxs("div",{className:"p-2",children:[r.jsx("h1",{className:"bg-gray-400 text-white px-2",children:r.jsx("span",{children:"Properties"})}),r.jsx("div",{className:"scrollbar-custom overflow-x-hidden overflow-y-auto p-2 border h-30 border-gray-200 select-none",children:e&&r.jsx(an,{props:e})})]})},an=({props:e})=>{const t=o=>{console.log(o)};return r.jsxs("div",{className:"z-30 text-sm",children:[r.jsxs("div",{className:"mb-4 ",children:[r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{className:"",children:"X:"}),r.jsx("input",{type:"number",name:"x",defaultValue:e.x,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{className:"",children:"Y:"}),r.jsx("input",{type:"number",name:"y",defaultValue:e.y,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{className:"",children:"Width:"}),r.jsx("input",{type:"number",name:"width",defaultValue:e.width,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Height:"}),r.jsx("input",{type:"number",name:"height",defaultValue:e.height,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Radius:"}),r.jsx("input",{type:"number",name:"radius",defaultValue:e.radius,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Enable Fill"}),r.jsx("input",{type:"checkbox",name:"enableFill",defaultChecked:e.enableFill,onChange:t,className:"ml-2"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Fill Color:"}),r.jsx("input",{type:"color",name:"fillColor",defaultValue:e.fillColor,onChange:t,className:"w-10 h-10 p-1 rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Enable Line"}),r.jsx("input",{type:"checkbox",name:"enableLine",defaultChecked:e.enableLine,onChange:t,className:"ml-2"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Line Color:"}),r.jsx("input",{type:"color",name:"lineColor",defaultValue:e.lineColor,onChange:t,className:"w-10 h-10 p-1 rounded"})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Shadow"}),r.jsx("input",{type:"checkbox",name:"shadow",defaultChecked:e.shadow,onChange:t,className:"ml-2"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Opacity:"}),r.jsx("input",{type:"number",name:"opacity",defaultValue:e.opacity,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]}),r.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[r.jsx("span",{children:"Layer:"}),r.jsx("input",{type:"number",name:"layer",defaultValue:e.layer,onChange:t,className:"w-16 px-2 py-1 text-black rounded"})]})]})]})},cn=e=>{const s={type:"rectangle",x:100,y:100,width:100,height:100,enableLine:!0,lineColor:"#000000",lineWidth:1,enableFill:!0,fillColor:"#fff",opacity:100,shadow:!1,radius:0,rotation:0},l=100,i=100,n=[];for(let a=0;a<l;a++){const c=100+a*i,d=100+a*i;n.push({...s,fillColor:"#ededed",x:c,y:d,layer:a+1,rotation:a+10})}e.action.dispatch("module-add",n)},dn=({data:{idSet:e,position:t,copiedItems:o},onClose:s})=>{const{t:l}=P(),{executeAction:i}=f.useContext(S);f.useEffect(()=>{const c=()=>{s()};return window.addEventListener("click",c),()=>{window.removeEventListener("click",c)}},[e,t]);const n=[{id:"copy",disabled:e.size===0},{id:"paste",disabled:!o},{id:"delete",disabled:e.size===0},{id:"duplicate",disabled:e.size===0},{id:"bringToFront",disabled:e.size===0},{id:"sendToBack",disabled:e.size===0}],a=c=>{switch(c){case"copy":i("selection-copy");break;case"paste":i("selection-paste",t);break;case"delete":i("selection-delete");break;case"duplicate":i("selection-duplicate");break}};return r.jsx("div",{className:"absolute bg-white shadow-lg rounded-md border border-gray-200 py-1 z-50",style:{top:t.y,left:t.x},children:n.map((c,d)=>{const h=l(c.id,{returnObjects:!0}),u=d===2||d===4||d===7;return r.jsxs("div",{children:[u&&r.jsx("div",{className:"border-t border-gray-200 my-1"}),r.jsx("button",{className:"w-full px-4 py-1.5 text-left text-sm hover:bg-gray-100 disabled:text-gray-400 disabled:hover:bg-transparent disabled:cursor-not-allowed",disabled:c.disabled,onClick:()=>a(c.id),title:h.tooltip,children:h.label})]},c.id)})})},hn=({file:e})=>{const t=f.useRef(null),o=f.useRef(null),[s,l]=f.useState([]),[i,n]=f.useState({x:0,y:0}),[a,c]=f.useState([]),[d,h]=f.useState(null),[u,p]=f.useState([]),[m,g]=f.useState(!1),[b,x]=f.useState({idSet:new Set,position:{x:0,y:0},copiedItems:!1}),[w,v]=f.useState(0),[F,M]=f.useState({width:0,height:0,offsetX:0,offsetY:0,scale:1,dx:0,dy:0,status:""}),E=f.useRef(null),[W,Y]=f.useState(!0);f.useEffect(()=>{let N;if(o.current){const xe=X();N=new Vi({container:o.current,data:{id:xe,modules:[]},config:{dpr:2},events:{onInitialized:()=>{cn(N)},onHistoryUpdated:C=>{l(C.toArray()),C.current&&v(C.current.id)},onModulesUpdated:C=>{const $=Array.from(C.values()).sort((z,we)=>z.layer-we.layer);c($)},onSelectionUpdated:(C,$)=>{p(Array.from(C)),h({...$})},onViewportUpdated:C=>{M(C)},onWorldMouseMove:C=>{n(C)},onContextMenu:(C,$,z)=>{console.log(C,$),x({idSet:C,position:$,copiedItems:z})}}}),t.current=N}const j=E.current;return j&&(j.addEventListener("focus",K),j.addEventListener("blur",G)),()=>{j&&(j.removeEventListener("focus",K),j.removeEventListener("blur",G)),N&&N.destroy()}},[e]);const K=()=>Y(!0),G=()=>Y(!1),ye=N=>{t.current&&t.current.execute("history-pick",N)},me=(N,j=null)=>{t.current.execute(N,j)};return r.jsx(S.Provider,{value:{focused:W,historyArray:s,selectedModules:u,selectedProps:d,historyCurrent:w,viewport:F,editorRef:t,applyHistoryNode:ye,executeAction:me},children:r.jsxs("div",{ref:E,"data-focused":W,autoFocus:!0,tabIndex:0,className:"outline-0 w-full h-full flex flex-col",children:[r.jsx(Ui,{}),r.jsx(ln,{}),r.jsxs("main",{className:"flex flex-row overflow-hidden h-full",children:[r.jsx(Hi,{}),r.jsxs("div",{className:"flex flex-col w-full h-full overflow-hidden relative",children:[r.jsx("div",{ref:o,"editor-container":"true",className:"relative overflow-hidden flex w-full h-full"}),r.jsx(Ki,{worldPoint:i}),m&&r.jsx(dn,{data:b,onClose:()=>{g(!1)}})]}),r.jsxs("div",{style:{width:200},className:"h-full flex-shrink-0 border-l border-gray-200",children:[r.jsx(rn,{}),r.jsx(Gi,{data:a,selected:u}),r.jsx(nn,{})]})]})]})})},un=e=>[],pn=()=>{const e="Untitled 1",t={},o={modules:un()};return{id:X(),name:e,config:t,data:o}},fn=e=>new Map(e.reduce((t,o)=>(t.push([o.id,o]),t),[])),bn=pn(),ee=fn([bn]),gn=()=>{const e=' group py-2 px-6 relative transition flex items-center">',t=" bg-gray-200",o=" hover:bg-gray-200",{fileList:s,currentFileId:l,closeFile:i,switchFile:n,handleCreating:a}=f.useContext(_);return r.jsxs("div",{className:"flex flex-row items-center text-sm select-none",children:[s.map(c=>{const d=c.id===l,h=e+(d?t:o),u=(d?"visible":"invisible")+" w-2 h-2 ml-4 opacity-50 hover:opacity-100 group-hover:visible w-2 h-2 cursor-pointer";return r.jsxs("div",{className:h,onClick:()=>{n(c.id)},children:[r.jsx("span",{children:c.name}),r.jsx("span",{onClick:p=>{i(c.id),p.preventDefault(),p.stopPropagation()},className:u,children:"×"})]},c.id)}),r.jsx("button",{className:"hover:cursor-pointer hover:opacity-100 cursor-pointer opacity-50",children:r.jsx(Be,{size:18,onClick:()=>{a(!0)}})})]})},yn=({children:e,defaultValue:t})=>{const[o,s]=f.useState(!1);return r.jsxs("div",{className:"relative w-20",children:[r.jsxs("div",{className:"flex items-center",onClick:()=>{s(!o)},children:[r.jsx(Ie,{}),t]}),o&&r.jsx("div",{onClick:()=>{s(!1)},className:"absolute top-full right-0 w-full",children:e})]})},mn=()=>{const[e,t]=f.useState("en"),o={en:"English",cn:"中文",jp:"日本語"},{i18n:s}=P();return r.jsx("div",{className:"flex flex-row items-center text-sm select-none",children:r.jsx(yn,{defaultValue:o[e],children:Object.keys(o).map((l,i)=>r.jsx("div",{onClick:()=>{s.changeLanguage(l),t(l)},children:o[l]},i))})})},xn=()=>{const e=f.useRef(new Map),[t,o]=f.useState(!1),[s,l]=f.useState(""),[i,n]=f.useState([]),a=e.current.size,c=a===0||t;console.log(s),f.useEffect(()=>{ee.size>0&&(e.current=ee,d(),l(h()[0].id))},[]);const d=()=>{const b=h();return n(b),b},h=()=>Array.from(e.current.values()),u=b=>{console.log(i),l(b)},p=b=>{const x=i.findIndex(v=>v.id===b);let w=i.length;if(x!==-1&&(e.current.delete(b),d(),i.splice(x,1),w--,s===b&&w>0)){let v=x+1;x===0&&(v=0),v>w&&(v=w-1),l(i[v].id)}},m=b=>{e.current.set(b.id,b),d(),l(b.id)},g=b=>{o(b)};return r.jsx(_.Provider,{value:{fileMap:e.current,fileList:i,creating:t,currentFileId:s,switchFile:u,closeFile:p,createFile:m,handleCreating:g},children:r.jsxs("div",{className:"w-full h-full flex flex-col select-none",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx(gn,{}),r.jsx(mn,{})]}),r.jsx("div",{className:"flex-1 overflow-hidden min-h-[600px]",children:i.map(b=>b.id===s?r.jsx(hn,{file:b},b.id):void 0)}),c&&r.jsx(ql,{bg:a?"#00000080":"#fff",onBgClick:()=>{a&&o(!1)}})]})})};function wn(){return r.jsx(xn,{})}const vn=[{id:"file",parent:null},{id:"newFile",parent:"file",shortcut:"Ctrl+N"},{id:"openFile",parent:"file",shortcut:"Ctrl+O"},{id:"saveFile",parent:"file",shortcut:"Ctrl+S"},{id:"saveAs",parent:"file"},{id:"importFile",parent:"file"},{id:"exportFile",parent:"file"},{id:"print",parent:"file"},{id:"closeFile",parent:"file"},{id:"exportFile_png",parent:"exportFile"},{id:"exportFile_pdf",parent:"exportFile"},{id:"exportFile_csv",parent:"exportFile"},{id:"edit",parent:null},{id:"undo",parent:"edit",shortcut:"Ctrl+Z"},{id:"redo",parent:"edit",shortcut:"Ctrl+Y"},{id:"cut",parent:"edit",shortcut:"Ctrl+X"},{id:"copy",parent:"edit",shortcut:"Ctrl+C"},{id:"paste",parent:"edit",shortcut:"Ctrl+V"},{id:"delete",parent:"edit",shortcut:"Del"},{id:"duplicate",parent:"edit",shortcut:"Ctrl+D"},{id:"selectAll",parent:"edit",shortcut:"Ctrl+A"},{id:"findReplace",parent:"edit",shortcut:"Ctrl+F"},{id:"view",parent:null},{id:"zoomIn",parent:"view",shortcut:"Ctrl++"},{id:"zoomOut",parent:"view",shortcut:"Ctrl+-"},{id:"fitToScreen",parent:"view"},{id:"toggleGrid",parent:"view"},{id:"toggleGuides",parent:"view"},{id:"fullscreenMode",parent:"view",shortcut:"F11"},{id:"shape",parent:null},{id:"addNode",parent:"shape"},{id:"deleteNode",parent:"shape"},{id:"moveNode",parent:"shape"},{id:"resizeNode",parent:"shape"},{id:"rotateNode",parent:"shape"},{id:"changeNodeColor",parent:"shape"},{id:"changeNodeBorder",parent:"shape"},{id:"changeNodeText",parent:"shape"},{id:"groupNodes",parent:"shape"},{id:"ungroupNodes",parent:"shape"},{id:"lockNode",parent:"shape"},{id:"unlockNode",parent:"shape"},{id:"connection",parent:null},{id:"addEdge",parent:"connection"},{id:"deleteEdge",parent:"connection"},{id:"changeEdgeStyle",parent:"connection"},{id:"changeEdgeColor",parent:"connection"},{id:"changeEdgeLabel",parent:"connection"},{id:"reverseEdge",parent:"connection"},{id:"text",parent:null},{id:"addText",parent:"text"},{id:"editText",parent:"text"},{id:"changeFont",parent:"text"},{id:"changeFontSize",parent:"text"},{id:"changeFontColor",parent:"text"},{id:"boldText",parent:"text",shortcut:"Ctrl+B"},{id:"italicText",parent:"text",shortcut:"Ctrl+I"},{id:"underlineText",parent:"text",shortcut:"Ctrl+U"},{id:"alignText",parent:"text"},{id:"layer",parent:null},{id:"sendToBack",parent:"layer"},{id:"bringToFront",parent:"layer"},{id:"sendBackward",parent:"layer"},{id:"bringForward",parent:"layer"},{id:"duplicateLayer",parent:"layer"},{id:"deleteLayer",parent:"layer"},{id:"toggleLayerVisibility",parent:"layer"}],Cn={actions:Object.fromEntries(vn.map(e=>[e.id,{...e,disabled:!1}]))},fe=U({name:"menu",initialState:Cn,reducers:{setDisabled:(e,t)=>{e.actions[t.payload.id]&&(e.actions[t.payload.id].disabled=t.payload.disabled)},triggerAction:(e,t)=>{const o=e.actions[t.payload];o&&o.disabled}}}),{setDisabled:Tn,triggerAction:Pn}=fe.actions,Mn=fe.reducer,Sn=[{id:"save",icon:"save",disabled:!0,divide:!0},{id:"undo",icon:"undo",disabled:!0},{id:"redo",icon:"redo",disabled:!0,divide:!0},{id:"delete",icon:"trash",disabled:!1},{id:"add",icon:"cross",disabled:!1,divide:!0},{id:"layerUp",icon:"layers",disabled:!1},{id:"layerDown",icon:"layers",disabled:!1},{id:"layerTop",icon:"layers",disabled:!1},{id:"layerBottom",icon:"layers",disabled:!1,divide:!0},{id:"group",icon:"group",disabled:!0},{id:"ungroup",icon:"ungroup",disabled:!0,divide:!0},{id:"lock",icon:"lock",disabled:!1},{id:"unlock",icon:"unlock",disabled:!0}],Nn={actions:Object.fromEntries(Sn.map(e=>[e.id,{...e,disabled:!1}]))},be=U({name:"menu",initialState:Nn,reducers:{setDisabled:(e,t)=>{e.actions[t.payload.id]&&(e.actions[t.payload.id].disabled=t.payload.disabled)},triggerAction:(e,t)=>{const o=e.actions[t.payload];o&&o.disabled}}}),{setDisabled:Dn,triggerAction:An}=be.actions,jn=be.reducer,Fn={zoom:1},ge=U({name:"statusBar",initialState:Fn,reducers:{setZoom:(e,t)=>{e.zoom=t.payload}}}),{setZoom:Rn}=ge.actions,kn=ge.reducer,En=Oe({reducer:{menu:Mn,toolbar:jn,statusBar:kn}});Ve.createRoot(document.getElementById("root")).render(r.jsx(Ue,{store:En,children:r.jsx(wn,{})}));
