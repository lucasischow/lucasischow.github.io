var fe=Object.defineProperty;var be=(t,e,o)=>e in t?fe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var h=(t,e,o)=>be(t,typeof e!="symbol"?e+"":e,o);import{i as ge,a as me,r as f,j as n,L as xe,b as ye,u as $,c as ve,d as oe,e as we,f as Ce,g as Me,h as Se,k as Ne,l as je,m as Fe,n as ke,o as Ee,p as Te,q as $e,s as V,t as Le,v as Ae,P as De}from"./vendor-CXYeIPxP.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(l){if(l.ep)return;l.ep=!0;const i=o(l);fetch(l.href,i)}})();const Re={label:"File",tooltip:"Open the file menu"},ze={label:"New File",tooltip:"Create a new file",shortcut:"Ctrl+N"},Pe={label:"Open File",tooltip:"Open an existing file",shortcut:"Ctrl+O"},Be={label:"Save File",tooltip:"Save the current file",shortcut:"Ctrl+S"},Ie={label:"Save As",tooltip:"Save the current file with a new name"},Oe={label:"Import File",tooltip:"Import a file into the project"},Ve={label:"Export",tooltip:"Export the current file"},Ue={label:"Export as PNG",tooltip:"Export the file as a PNG image"},Xe={label:"Export as PDF",tooltip:"Export the file as a PDF document"},Ye={label:"Export as CSV",tooltip:"Export the file as a CSV file"},He={label:"Print",tooltip:"Print the current file"},_e={label:"Close File",tooltip:"Close the current file"},Ge={label:"Edit",tooltip:"Open the edit menu"},Ke={label:"Undo",tooltip:"Undo the last action",shortcut:"Ctrl+Z"},We={label:"Redo",tooltip:"Redo the last undone action",shortcut:"Ctrl+Y"},Ze={label:"Cut",tooltip:"Cut the selected content",shortcut:"Ctrl+X"},qe={label:"Copy",tooltip:"Copy the selected content",shortcut:"Ctrl+C"},Qe={label:"Paste",tooltip:"Paste the copied content",shortcut:"Ctrl+V"},Je={label:"Duplicate",tooltip:"Duplicate the selected content",shortcut:"Ctrl+D"},et={label:"Select All",tooltip:"Select all content",shortcut:"Ctrl+A"},tt={label:"Find & Replace",tooltip:"Find and replace text",shortcut:"Ctrl+F"},ot={label:"View",tooltip:"Open the view menu"},st={label:"Zoom In",tooltip:"Zoom in on the document",shortcut:"Ctrl++"},lt={label:"Zoom Out",tooltip:"Zoom out of the document",shortcut:"Ctrl+-"},it={label:"Fit to Screen",tooltip:"Fit the content to the screen"},nt={label:"Toggle Grid",tooltip:"Show or hide the grid"},at={label:"Toggle Guides",tooltip:"Show or hide the guides"},rt={label:"Fullscreen Mode",tooltip:"Switch to fullscreen mode",shortcut:"F11"},ct={label:"Shape",tooltip:"Open the shape menu"},dt={label:"Add Node",tooltip:"Add a new node to the diagram"},ht={label:"Delete Node",tooltip:"Delete the selected node"},ut={label:"Move Node",tooltip:"Move the selected node"},pt={label:"Resize Node",tooltip:"Resize the selected node"},ft={label:"Rotate Node",tooltip:"Rotate the selected node"},bt={label:"Change Node Color",tooltip:"Change the color of the selected node"},gt={label:"Change Node Border",tooltip:"Change the border of the selected node"},mt={label:"Change Node Text",tooltip:"Edit the text of the selected node"},xt={label:"Group Nodes",tooltip:"Group selected nodes together"},yt={label:"Ungroup Nodes",tooltip:"Ungroup the selected nodes"},vt={label:"Lock Node",tooltip:"Lock the selected node"},wt={label:"Unlock Node",tooltip:"Unlock the selected node"},Ct={label:"Connection",tooltip:"Open the connection menu"},Mt={label:"Add Edge",tooltip:"Add an edge between nodes"},St={label:"Delete Edge",tooltip:"Delete the selected edge"},Nt={label:"Change Edge Style",tooltip:"Change the style of the selected edge"},jt={label:"Change Edge Color",tooltip:"Change the color of the selected edge"},Ft={label:"Change Edge Label",tooltip:"Change the label of the selected edge"},kt={label:"Reverse Edge",tooltip:"Reverse the direction of the selected edge"},Et={label:"Text",tooltip:"Open the text menu"},Tt={label:"Add Text",tooltip:"Add text to the document"},$t={label:"Edit Text",tooltip:"Edit the selected text"},Lt={label:"Change Font",tooltip:"Change the font of the selected text"},At={label:"Change Font Size",tooltip:"Change the font size of the selected text"},Dt={label:"Change Font Color",tooltip:"Change the font color of the selected text"},Rt={label:"Bold Text",tooltip:"Make the selected text bold",shortcut:"Ctrl+B"},zt={label:"Italic Text",tooltip:"Make the selected text italic",shortcut:"Ctrl+I"},Pt={label:"Underline Text",tooltip:"Underline the selected text",shortcut:"Ctrl+U"},Bt={label:"Align Text",tooltip:"Align the selected text"},It={label:"Layer",tooltip:"Open the layer menu"},Ot={label:"Send to Back",tooltip:"Send the selected layer to the back"},Vt={label:"Bring to Front",tooltip:"Bring the selected layer to the front"},Ut={label:"Send Backward",tooltip:"Send the selected layer one step backward"},Xt={label:"Bring Forward",tooltip:"Bring the selected layer one step forward"},Yt={label:"Duplicate Layer",tooltip:"Duplicate the selected layer"},Ht={label:"Delete Layer",tooltip:"Delete the selected layer"},_t={label:"Toggle Layer Visibility",tooltip:"Show or hide the selected layer"},Gt={label:"Collaboration",tooltip:"Open the collaboration menu"},Kt={label:"Add Comment",tooltip:"Add a comment to the document"},Wt={label:"Edit Comment",tooltip:"Edit the selected comment"},Zt={label:"Delete Comment",tooltip:"Delete the selected comment"},qt={label:"Share Document",tooltip:"Share the document with others"},Qt={file:Re,newFile:ze,openFile:Pe,saveFile:Be,saveAs:Ie,importFile:Oe,exportFile:Ve,exportFile_png:Ue,exportFile_pdf:Xe,exportFile_csv:Ye,print:He,closeFile:_e,edit:Ge,undo:Ke,redo:We,cut:Ze,copy:qe,paste:Qe,delete:{label:"Delete",tooltip:"Delete the selected content",shortcut:"Del"},duplicate:Je,selectAll:et,findReplace:tt,view:ot,zoomIn:st,zoomOut:lt,fitToScreen:it,toggleGrid:nt,toggleGuides:at,fullscreenMode:rt,shape:ct,addNode:dt,deleteNode:ht,moveNode:ut,resizeNode:pt,rotateNode:ft,changeNodeColor:bt,changeNodeBorder:gt,changeNodeText:mt,groupNodes:xt,ungroupNodes:yt,lockNode:vt,unlockNode:wt,connection:Ct,addEdge:Mt,deleteEdge:St,changeEdgeStyle:Nt,changeEdgeColor:jt,changeEdgeLabel:Ft,reverseEdge:kt,text:Et,addText:Tt,editText:$t,changeFont:Lt,changeFontSize:At,changeFontColor:Dt,boldText:Rt,italicText:zt,underlineText:Pt,alignText:Bt,layer:It,sendToBack:Ot,bringToFront:Vt,sendBackward:Ut,bringForward:Xt,duplicateLayer:Yt,deleteLayer:Ht,toggleLayerVisibility:_t,collaboration:Gt,addComment:Kt,editComment:Wt,deleteComment:Zt,shareDocument:qt},Jt={init:{label:"Init",tooltip:"Initialize the file"},add:{label:"Add",tooltip:"Add modules to the file"},delete:{label:"Delete",tooltip:"Delete modules from the file"},paste:{label:"Paste",tooltip:"Paste modules into the file"},duplicate:{label:"Duplicate",tooltip:"Duplicate selected modules"},modify:{label:"Modify",tooltip:"Modify the properties of modules"},move:{label:"Move",tooltip:"Move modules"},reorder:{label:"Reorder",tooltip:"Reorder modules"},select:{label:"Select",tooltip:"Select modules"},group:{label:"Group",tooltip:"Group modules"},ungroup:{label:"Ungroup",tooltip:"Ungroup modules"},composite:{label:"Composite",tooltip:"Composite operation"}},eo={history:Jt},to={label:"文件",tooltip:"打开文件菜单"},oo={label:"新建文件",tooltip:"创建新文件",shortcut:"Ctrl+N"},so={label:"打开文件",tooltip:"打开现有文件",shortcut:"Ctrl+O"},lo={label:"保存文件",tooltip:"保存当前文件",shortcut:"Ctrl+S"},io={label:"另存为",tooltip:"以新名称保存当前文件"},no={label:"导入文件",tooltip:"将文件导入到项目中"},ao={label:"导出",tooltip:"导出当前文件"},ro={label:"导出为PNG",tooltip:"将文件导出为PNG图像"},co={label:"导出为PDF",tooltip:"将文件导出为PDF文档"},ho={label:"导出为CSV",tooltip:"将文件导出为CSV文件"},uo={label:"打印",tooltip:"打印当前文件"},po={label:"关闭文件",tooltip:"关闭当前文件"},fo={label:"编辑",tooltip:"打开编辑菜单"},bo={label:"撤销",tooltip:"撤销上一步操作",shortcut:"Ctrl+Z"},go={label:"重做",tooltip:"重做上一次撤销的操作",shortcut:"Ctrl+Y"},mo={label:"剪切",tooltip:"剪切选定的内容",shortcut:"Ctrl+X"},xo={label:"复制",tooltip:"复制选定的内容",shortcut:"Ctrl+C"},yo={label:"粘贴",tooltip:"粘贴复制的内容",shortcut:"Ctrl+V"},vo={label:"复制",tooltip:"复制选定的内容",shortcut:"Ctrl+D"},wo={label:"全选",tooltip:"选择所有内容",shortcut:"Ctrl+A"},Co={label:"查找和替换",tooltip:"查找和替换文本",shortcut:"Ctrl+F"},Mo={label:"视图",tooltip:"打开视图菜单"},So={label:"放大",tooltip:"放大文档",shortcut:"Ctrl++"},No={label:"缩小",tooltip:"缩小文档",shortcut:"Ctrl+-"},jo={label:"适应屏幕",tooltip:"使内容适应屏幕"},Fo={label:"切换网格",tooltip:"显示或隐藏网格"},ko={label:"切换参考线",tooltip:"显示或隐藏参考线"},Eo={label:"全屏模式",tooltip:"切换到全屏模式",shortcut:"F11"},To={label:"形状",tooltip:"打开形状菜单"},$o={label:"添加节点",tooltip:"向图表添加新节点"},Lo={label:"删除节点",tooltip:"删除选定的节点"},Ao={label:"移动节点",tooltip:"移动选定的节点"},Do={label:"调整节点大小",tooltip:"调整选定节点的大小"},Ro={label:"旋转节点",tooltip:"旋转选定的节点"},zo={label:"更改节点颜色",tooltip:"更改选定节点的颜色"},Po={label:"更改节点边框",tooltip:"更改选定节点的边框"},Bo={label:"更改节点文本",tooltip:"编辑选定节点的文本"},Io={label:"组合节点",tooltip:"将选定的节点组合在一起"},Oo={label:"取消组合节点",tooltip:"取消组合选定的节点"},Vo={label:"锁定节点",tooltip:"锁定选定的节点"},Uo={label:"解锁节点",tooltip:"解锁选定的节点"},Xo={label:"连接",tooltip:"打开连接菜单"},Yo={label:"添加边",tooltip:"在节点之间添加边"},Ho={label:"删除边",tooltip:"删除选定的边"},_o={label:"更改边样式",tooltip:"更改选定边的样式"},Go={label:"更改边颜色",tooltip:"更改选定边的颜色"},Ko={label:"更改边标签",tooltip:"更改选定边的标签"},Wo={label:"反转边",tooltip:"反转选定边的方向"},Zo={label:"文本",tooltip:"打开文本菜单"},qo={label:"添加文本",tooltip:"向文档添加文本"},Qo={label:"编辑文本",tooltip:"编辑选定的文本"},Jo={label:"更改字体",tooltip:"更改选定文本的字体"},es={label:"更改字体大小",tooltip:"更改选定文本的字体大小"},ts={label:"更改字体颜色",tooltip:"更改选定文本的字体颜色"},os={label:"粗体文本",tooltip:"将选定的文本设置为粗体",shortcut:"Ctrl+B"},ss={label:"斜体文本",tooltip:"将选定的文本设置为斜体",shortcut:"Ctrl+I"},ls={label:"下划线文本",tooltip:"为选定的文本添加下划线",shortcut:"Ctrl+U"},is={label:"对齐文本",tooltip:"对齐选定的文本"},ns={label:"图层",tooltip:"打开图层菜单"},as={label:"置于底层",tooltip:"将选定的图层置于底层"},rs={label:"置于顶层",tooltip:"将选定的图层置于顶层"},cs={label:"下移一层",tooltip:"将选定的图层下移一层"},ds={label:"上移一层",tooltip:"将选定的图层上移一层"},hs={label:"复制图层",tooltip:"复制选定的图层"},us={label:"删除图层",tooltip:"删除选定的图层"},ps={label:"切换图层可见性",tooltip:"显示或隐藏选定的图层"},fs={label:"协作",tooltip:"打开协作菜单"},bs={label:"添加评论",tooltip:"向文档添加评论"},gs={label:"编辑评论",tooltip:"编辑选定的评论"},ms={label:"删除评论",tooltip:"删除选定的评论"},xs={label:"分享文档",tooltip:"与他人分享文档"},ys={file:to,newFile:oo,openFile:so,saveFile:lo,saveAs:io,importFile:no,exportFile:ao,exportFile_png:ro,exportFile_pdf:co,exportFile_csv:ho,print:uo,closeFile:po,edit:fo,undo:bo,redo:go,cut:mo,copy:xo,paste:yo,delete:{label:"删除",tooltip:"删除选定的内容",shortcut:"Del"},duplicate:vo,selectAll:wo,findReplace:Co,view:Mo,zoomIn:So,zoomOut:No,fitToScreen:jo,toggleGrid:Fo,toggleGuides:ko,fullscreenMode:Eo,shape:To,addNode:$o,deleteNode:Lo,moveNode:Ao,resizeNode:Do,rotateNode:Ro,changeNodeColor:zo,changeNodeBorder:Po,changeNodeText:Bo,groupNodes:Io,ungroupNodes:Oo,lockNode:Vo,unlockNode:Uo,connection:Xo,addEdge:Yo,deleteEdge:Ho,changeEdgeStyle:_o,changeEdgeColor:Go,changeEdgeLabel:Ko,reverseEdge:Wo,text:Zo,addText:qo,editText:Qo,changeFont:Jo,changeFontSize:es,changeFontColor:ts,boldText:os,italicText:ss,underlineText:ls,alignText:is,layer:ns,sendToBack:as,bringToFront:rs,sendBackward:cs,bringForward:ds,duplicateLayer:hs,deleteLayer:us,toggleLayerVisibility:ps,collaboration:fs,addComment:bs,editComment:gs,deleteComment:ms,shareDocument:xs},vs={init:{label:"初始化",tooltip:"初始化文件"},add:{label:"添加",tooltip:"向文件添加模块"},delete:{label:"删除",tooltip:"从文件中删除模块"},paste:{label:"粘贴",tooltip:"将模块粘贴到文件中"},duplicate:{label:"复制",tooltip:"复制选定的模块"},modify:{label:"修改",tooltip:"修改模块的属性"},move:{label:"移动",tooltip:"移动模块"},reorder:{label:"重新排序",tooltip:"重新排序模块"},select:{label:"选择",tooltip:"选择模块"},group:{label:"组合",tooltip:"组合模块"},ungroup:{label:"取消组合",tooltip:"取消模块组合"},composite:{label:"复合操作",tooltip:"复合操作"}},ws={history:vs},Cs={label:"ファイル",tooltip:"ファイルメニューを開く"},Ms={label:"新規ファイル",tooltip:"新規ファイルを作成",shortcut:"Ctrl+N"},Ss={label:"ファイルを開く",tooltip:"既存のファイルを開く",shortcut:"Ctrl+O"},Ns={label:"ファイルを保存",tooltip:"現在のファイルを保存",shortcut:"Ctrl+S"},js={label:"名前を付けて保存",tooltip:"現在のファイルに新しい名前を付けて保存"},Fs={label:"ファイルをインポート",tooltip:"プロジェクトにファイルをインポート"},ks={label:"エクスポート",tooltip:"現在のファイルをエクスポート"},Es={label:"PNGとしてエクスポート",tooltip:"ファイルをPNG画像としてエクスポート"},Ts={label:"PDFとしてエクスポート",tooltip:"ファイルをPDFドキュメントとしてエクスポート"},$s={label:"CSVとしてエクスポート",tooltip:"ファイルをCSVファイルとしてエクスポート"},Ls={label:"印刷",tooltip:"現在のファイルを印刷"},As={label:"ファイルを閉じる",tooltip:"現在のファイルを閉じる"},Ds={label:"編集",tooltip:"編集メニューを開く"},Rs={label:"元に戻す",tooltip:"最後のアクションを元に戻す",shortcut:"Ctrl+Z"},zs={label:"やり直し",tooltip:"最後に元に戻したアクションをやり直す",shortcut:"Ctrl+Y"},Ps={label:"切り取り",tooltip:"選択したコンテンツを切り取り",shortcut:"Ctrl+X"},Bs={label:"コピー",tooltip:"選択したコンテンツをコピー",shortcut:"Ctrl+C"},Is={label:"貼り付け",tooltip:"コピーしたコンテンツを貼り付け",shortcut:"Ctrl+V"},Os={label:"複製",tooltip:"選択したコンテンツを複製",shortcut:"Ctrl+D"},Vs={label:"すべて選択",tooltip:"すべてのコンテンツを選択",shortcut:"Ctrl+A"},Us={label:"検索と置換",tooltip:"テキストを検索して置換",shortcut:"Ctrl+F"},Xs={label:"表示",tooltip:"表示メニューを開く"},Ys={label:"拡大",tooltip:"ドキュメントを拡大",shortcut:"Ctrl++"},Hs={label:"縮小",tooltip:"ドキュメントを縮小",shortcut:"Ctrl+-"},_s={label:"画面に合わせる",tooltip:"コンテンツを画面に合わせる"},Gs={label:"グリッドの切り替え",tooltip:"グリッドを表示または非表示"},Ks={label:"ガイドの切り替え",tooltip:"ガイドを表示または非表示"},Ws={label:"全画面モード",tooltip:"全画面モードに切り替え",shortcut:"F11"},Zs={label:"図形",tooltip:"図形メニューを開く"},qs={label:"ノードを追加",tooltip:"ダイアグラムに新しいノードを追加"},Qs={label:"ノードを削除",tooltip:"選択したノードを削除"},Js={label:"ノードを移動",tooltip:"選択したノードを移動"},el={label:"ノードのサイズを変更",tooltip:"選択したノードのサイズを変更"},tl={label:"ノードを回転",tooltip:"選択したノードを回転"},ol={label:"ノードの色を変更",tooltip:"選択したノードの色を変更"},sl={label:"ノードの境界線を変更",tooltip:"選択したノードの境界線を変更"},ll={label:"ノードのテキストを変更",tooltip:"選択したノードのテキストを編集"},il={label:"ノードをグループ化",tooltip:"選択したノードをグループ化"},nl={label:"ノードのグループ化を解除",tooltip:"選択したノードのグループ化を解除"},al={label:"ノードをロック",tooltip:"選択したノードをロック"},rl={label:"ノードのロックを解除",tooltip:"選択したノードのロックを解除"},cl={label:"接続",tooltip:"接続メニューを開く"},dl={label:"エッジを追加",tooltip:"ノード間にエッジを追加"},hl={label:"エッジを削除",tooltip:"選択したエッジを削除"},ul={label:"エッジのスタイルを変更",tooltip:"選択したエッジのスタイルを変更"},pl={label:"エッジの色を変更",tooltip:"選択したエッジの色を変更"},fl={label:"エッジのラベルを変更",tooltip:"選択したエッジのラベルを変更"},bl={label:"エッジの方向を反転",tooltip:"選択したエッジの方向を反転"},gl={label:"テキスト",tooltip:"テキストメニューを開く"},ml={label:"テキストを追加",tooltip:"ドキュメントにテキストを追加"},xl={label:"テキストを編集",tooltip:"選択したテキストを編集"},yl={label:"フォントを変更",tooltip:"選択したテキストのフォントを変更"},vl={label:"フォントサイズを変更",tooltip:"選択したテキストのフォントサイズを変更"},wl={label:"フォントの色を変更",tooltip:"選択したテキストのフォントの色を変更"},Cl={label:"テキストを太字にする",tooltip:"選択したテキストを太字にする",shortcut:"Ctrl+B"},Ml={label:"テキストを斜体にする",tooltip:"選択したテキストを斜体にする",shortcut:"Ctrl+I"},Sl={label:"テキストに下線を引く",tooltip:"選択したテキストに下線を引く",shortcut:"Ctrl+U"},Nl={label:"テキストを配置",tooltip:"選択したテキストを配置"},jl={label:"レイヤー",tooltip:"レイヤーメニューを開く"},Fl={label:"最背面へ移動",tooltip:"選択したレイヤーを最背面へ移動"},kl={label:"最前面へ移動",tooltip:"選択したレイヤーを最前面へ移動"},El={label:"背面へ移動",tooltip:"選択したレイヤーを1つ背面へ移動"},Tl={label:"前面へ移動",tooltip:"選択したレイヤーを1つ前面へ移動"},$l={label:"レイヤーを複製",tooltip:"選択したレイヤーを複製"},Ll={label:"レイヤーを削除",tooltip:"選択したレイヤーを削除"},Al={label:"レイヤーの表示/非表示を切り替え",tooltip:"選択したレイヤーの表示/非表示を切り替え"},Dl={label:"コラボレーション",tooltip:"コラボレーションメニューを開く"},Rl={label:"コメントを追加",tooltip:"ドキュメントにコメントを追加"},zl={label:"コメントを編集",tooltip:"選択したコメントを編集"},Pl={label:"コメントを削除",tooltip:"選択したコメントを削除"},Bl={label:"ドキュメントを共有",tooltip:"ドキュメントを他のユーザーと共有"},Il={file:Cs,newFile:Ms,openFile:Ss,saveFile:Ns,saveAs:js,importFile:Fs,exportFile:ks,exportFile_png:Es,exportFile_pdf:Ts,exportFile_csv:$s,print:Ls,closeFile:As,edit:Ds,undo:Rs,redo:zs,cut:Ps,copy:Bs,paste:Is,delete:{label:"削除",tooltip:"選択したコンテンツを削除",shortcut:"Del"},duplicate:Os,selectAll:Vs,findReplace:Us,view:Xs,zoomIn:Ys,zoomOut:Hs,fitToScreen:_s,toggleGrid:Gs,toggleGuides:Ks,fullscreenMode:Ws,shape:Zs,addNode:qs,deleteNode:Qs,moveNode:Js,resizeNode:el,rotateNode:tl,changeNodeColor:ol,changeNodeBorder:sl,changeNodeText:ll,groupNodes:il,ungroupNodes:nl,lockNode:al,unlockNode:rl,connection:cl,addEdge:dl,deleteEdge:hl,changeEdgeStyle:ul,changeEdgeColor:pl,changeEdgeLabel:fl,reverseEdge:bl,text:gl,addText:ml,editText:xl,changeFont:yl,changeFontSize:vl,changeFontColor:wl,boldText:Cl,italicText:Ml,underlineText:Sl,alignText:Nl,layer:jl,sendToBack:Fl,bringToFront:kl,sendBackward:El,bringForward:Tl,duplicateLayer:$l,deleteLayer:Ll,toggleLayerVisibility:Al,collaboration:Dl,addComment:Rl,editComment:zl,deleteComment:Pl,shareDocument:Bl},Ol={init:{label:"初期化",tooltip:"ファイルを初期化する"},add:{label:"追加",tooltip:"ファイルにモジュールを追加する"},delete:{label:"削除",tooltip:"ファイルからモジュールを削除する"},paste:{label:"貼り付け",tooltip:"ファイルにモジュールを貼り付ける"},duplicate:{label:"複製",tooltip:"選択したモジュールを複製する"},modify:{label:"修正",tooltip:"モジュールのプロパティを修正する"},move:{label:"移動",tooltip:"モジュールを移動する"},reorder:{label:"並べ替え",tooltip:"モジュールを並べ替える"},select:{label:"選択",tooltip:"モジュールを選択する"},group:{label:"グループ化",tooltip:"モジュールをグループ化する"},ungroup:{label:"グループ化解除",tooltip:"モジュールのグループ化を解除する"},composite:{label:"複合操作",tooltip:"複合操作"}},Vl={history:Ol},Ul={en:{translation:{...Qt,...eo}},cn:{translation:{...ys,...ws}},jp:{translation:{...Il,...Vl}}};ge.use(me).init({resources:Ul,lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});const U=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),X=f.createContext({fileMap:new Map([["fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",{id:"fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",name:"Untitled 1",config:{},data:{}}]]),fileList:[],currentFileId:"fbbeddd8-0996-4ebb-8c1e-9d1ea5312ebb",creating:!1,switchFile:()=>{},closeFile:()=>{},createFile:()=>{},handleCreating:()=>{}}),Xl=({bg:t="#fff",onBgClick:e})=>{const o=f.useRef(null),{createFile:s,handleCreating:l}=f.useContext(X),[i,a]=f.useState(""),r=d=>/^[a-zA-Z0-9-_ ]+$/.test(d),c=d=>{var b;d.preventDefault(),d.stopPropagation();const u=(b=o.current)==null?void 0:b.filename.value.trim();if(!r(u)){a("File name can only including number space and alpha");return}a("");const p={id:U(),name:u,data:{},config:{}};s(p),l(!1)};return n.jsxs("div",{className:"fixed top-0 left-0 z-20 w-full h-full flex flex-row items-center justify-center text-sm select-none",children:[n.jsx("div",{style:{backgroundColor:t},onClick:()=>e&&e(),className:"absolute top-0 left-0 w-full h-full flex flex-row items-center justify-center text-sm select-none"}),n.jsxs("form",{ref:o,className:"relative w-100 min-h-30 z-20 p-4 bg-white rounded-xl shadow-2xl",onSubmit:c,children:[n.jsx("h1",{className:"text-xl text-center",children:"New File"}),n.jsx("label",{htmlFor:"filename",className:"block text-gray-700 font-medium mb-2",children:"File Name"}),n.jsx("input",{type:"text",autoFocus:!0,id:"filename",name:"filename",placeholder:"Enter file name",className:"w-full bg-gray-100 border border-gray-300 text-gray-700 py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"}),i&&n.jsx("div",{className:"text-red-500 my-2",children:i}),n.jsx("label",{className:"justify-center",children:n.jsx("button",{type:"submit",className:"mt-2 w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-300",children:"Create File"})})]})]})};function F(t){return t===null?"null":t===void 0?"undefined":t instanceof Set?"set":t instanceof Map?"map":Array.isArray(t)?"array":t instanceof Date?"date":t instanceof RegExp?"regexp":t instanceof Error?"error":t instanceof Promise?"promise":t instanceof ArrayBuffer?"arraybuffer":ArrayBuffer.isView(t)?"typedarray":t instanceof WeakSet?"weakset":t instanceof WeakMap?"weakmap":typeof t=="function"?"function":typeof t=="symbol"?"symbol":typeof t=="bigint"?"bigint":typeof t=="object"?"object":typeof t}const G=50,K=100;class Yl{constructor(e){h(this,"selectedModules",new Set);h(this,"resizeHandleSize",10);h(this,"activeResizeHandle",null);h(this,"isDestroyed",!1);h(this,"editor");h(this,"copiedItems",[]);h(this,"isSelectAll",!1);this.editor=e}getSelected(){return this.isSelectAll?"all":new Set(this.selectedModules.keys())}modifySelection(e,o){var l,i;if(F(e)!=="set"||e.size<=0)return;let s=null;if(e.size===1){const a=[...e.values()][0];this.editor.moduleMap.has(a)&&(s=this.editor.moduleMap.get(a).getDetails())}o==="replace"&&this.selectedModules.clear(),e.forEach(a=>{switch(o){case"add":this.selectedModules.add(a);break;case"delete":this.selectedModules.delete(a);break;case"toggle":this.selectedModules.has(a)?this.selectedModules.delete(a):this.selectedModules.add(a);break;case"replace":this.selectedModules.add(a);break}}),this.render(),(i=(l=this.editor.events).onSelectionUpdated)==null||i.call(l,e,s)}add(e){this.modifySelection(e,"add")}delete(e){this.modifySelection(e,"delete")}toggle(e){this.modifySelection(e,"toggle")}replace(e){this.modifySelection(e,"replace")}selectAll(){var e,o;this.selectedModules.clear(),this.isSelectAll=!0,this.render(),(o=(e=this.editor.events).onSelectionUpdated)==null||o.call(e,"all",null)}clear(){var e,o;this.selectedModules.clear(),this.isSelectAll=!1,this.render(),(o=(e=this.editor.events).onSelectionUpdated)==null||o.call(e,new Set,null)}copySelected(){this.copiedItems=[],this.copiedItems=this.editor.batchCopy(this.isSelectAll?"all":this.selectedModules,!0),this.updateCopiedItemsDelta()}pasteCopied(){const e=this.editor.batchCreate(this.copiedItems);this.editor.batchAdd(e,"paste"),this.replace(new Set(e.keys())),this.updateCopiedItemsDelta()}duplicateSelected(){let e;this.isSelectAll?e=this.editor.batchCopy("all",!0):e=this.editor.batchCopy(this.selectedModules,!0),e.forEach(s=>{s.x+=G,s.y+=K});const o=this.editor.batchCreate(e);this.editor.batchAdd(o,"duplicate"),this.isSelectAll=!1,this.replace(new Set(o.keys()))}removeSelected(){this.isSelectAll?this.editor.batchDelete("all","delete"):this.editor.batchDelete(this.selectedModules,"delete"),this.editor.selectionManager.clear()}updateCopiedItemsDelta(){this.copiedItems.forEach(e=>{e.x+=G,e.y+=K})}getIfUnique(){return this.selectedModules.size===1?[...this.selectedModules.values()][0]:null}update(){var o,s;let e=null;this.selectedModules.size===1&&this.selectedModules.forEach(l=>{e=this.editor.moduleMap.get(l).getDetails()}),this.render(),(s=(o=this.editor.events).onSelectionUpdated)==null||s.call(o,this.selectedModules,e)}render(){this.editor.viewport.resetSelectionCanvas(),this.editor.viewport.renderSelectionCanvas()}destroy(){this.isDestroyed||(this.selectedModules.clear(),this.isDestroyed=!0,console.log("SelectionModule destroyed."))}}class W{constructor(e,o,s,l=-1){h(this,"data");h(this,"prev");h(this,"next");h(this,"id");this.data=s,this.prev=e,this.next=o,this.id=l}}class Hl{constructor(){h(this,"head");h(this,"tail");h(this,"current");this.head=null,this.tail=null,this.current=null}detach(){return this.current&&(this.current.next=null,this.tail=this.current),this.current}append(e){let o;const{tail:s}=this;return s?(o=new W(s,null,e,s.id+1),s.next=o,this.tail=o):(o=new W(null,null,e,0),this.head=o,this.tail=o),this.current=o,o}back(){return this.current===this.head?!1:(this.current=this.current.prev,this.current)}forward(){return this.current===this.tail?!1:(this.current=this.current.next,this.current)}compareToCurrentPosition(e){if(e===this.current)return"equal";let o=this.head;for(;o;){if(this.current===o)return"behind";if(e===o)return"front";o=o.next}return!1}destroy(){this.head=null,this.tail=null,this.current=null}}const Z=t=>new Set(t.map(e=>e.id));class _l extends Hl{constructor(o){super();h(this,"editor");this.editor=o,this.init()}init(){var o,s;this.append({type:"init",payload:{state:null,selectedModules:"all"}}),(s=(o=this.editor.events).onHistoryUpdated)==null||s.call(o,this)}add(o){var s,l;this.detach(),this.append(o),(l=(s=this.editor.events).onHistoryUpdated)==null||l.call(s,this)}undo(o=!1){var c,d;const s=this.current;if(!s)return!1;const{type:l,payload:i}=s.data,{selectedModules:a}=i;let r=null;switch(l){case"init":break;case"add":case"paste":case"duplicate":this.editor.batchDelete(Z(i.modules));break;case"modify":break;case"move":this.editor.batchMove(i.selectedModules,{x:-i.delta.x,y:-i.delta.y});break;case"reorder":break;case"group":break;case"ungroup":break;case"composite":break;case"delete":r=i.modules,this.editor.batchAdd(this.editor.batchCreate(r));break}return super.back(),o||(a==="all"?this.editor.selectionManager.selectAll():this.editor.selectionManager.replace(a),(d=(c=this.editor.events).onHistoryUpdated)==null||d.call(c,this)),this.current}redo(o=!1){var r,c;const s=super.forward();if(!s)return!1;const{type:l,payload:i}=s.data,{selectedModules:a}=i;switch(l){case"init":break;case"add":case"paste":case"duplicate":this.editor.batchAdd(this.editor.batchCreate(i.modules));break;case"modify":break;case"move":this.editor.batchMove(i.selectedModules,{x:i.delta.x,y:i.delta.y});break;case"reorder":break;case"group":break;case"ungroup":break;case"composite":break;case"delete":this.editor.batchDelete(Z(i.modules));break}return o||(a==="all"?this.editor.selectionManager.selectAll():this.editor.selectionManager.replace(a),(c=(r=this.editor.events).onHistoryUpdated)==null||c.call(r,this)),this.current}moveCurrentToTargetById(o){var l,i;const s=super.compareToCurrentPosition(o);if(!(!s||s==="equal")&&(s==="front"||s==="behind")){let r;for(;s==="front"?r=this.undo(!0):s==="behind"&&(r=this.redo(!0)),r!==o;);const{selectedModules:c}=o.data.payload;c==="all"?this.editor.selectionManager.selectAll():this.editor.selectionManager.replace(c),(i=(l=this.editor.events).onHistoryUpdated)==null||i.call(l,this)}}toArray(){const o=[];if(this.head){let s=this.head;for(o.push(s);s.next;)o.push(s.next),s=s.next}return o}}class se{constructor({id:e,type:o,lineColor:s,lineWidth:l=1,opacity:i=100,layer:a=1,rotation:r=0,shadow:c=!1,enableLine:d=!0}){h(this,"id");h(this,"type");h(this,"enableLine");h(this,"lineWidth");h(this,"lineColor");h(this,"opacity");h(this,"rotation");h(this,"shadow");h(this,"layer");this.id=e,this.type=o,this.enableLine=d,this.lineColor=s,this.lineWidth=l,this.opacity=i,this.rotation=r,this.shadow=c,this.layer=a}getDetails(){return{id:this.id,type:this.type,enableLine:this.enableLine,lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,shadow:this.shadow,layer:this.layer,rotation:this.rotation}}getBoundingRect(){return{x:0,y:0,width:0,height:0,top:0,left:0,right:0,bottom:0,cx:0,cy:0}}}const Gl=({x:t,y:e,width:o,height:s},l)=>{const i=t+o/2,a=e+s/2,r=l*Math.PI/180,c=Math.cos(r),d=Math.sin(r),u=Math.abs(o*c)+Math.abs(s*d),p=Math.abs(o*d)+Math.abs(s*c),b=i-u/2,x=a-p/2;return Y({x:b,y:x,width:u,height:p})},Y=t=>{const{x:e,y:o,width:s,height:l}=t;return{x:e,y:o,width:s,height:l,top:o,bottom:o+l,left:e,right:e+s,cx:e+s/2,cy:o+l/2}},q=(t,e)=>{const o=Math.min(t.x,e.x),s=Math.max(t.x,e.x),l=Math.min(t.y,e.y),i=Math.max(t.y,e.y);return Y({x:o,y:l,width:s-o,height:i-l})};function Kl(t,e){return!(t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function Wl(t,e){return t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom}const Zl=({x:t,y:e},o,s)=>{const{x:l,y:i,width:a,height:r}=o;if(a<=0||r<=0)return!1;if(s===0){const v=a/2,C=r/2;return t>=l-v&&t<=l+v&&e>=i-C&&e<=i+C}const c=s*(Math.PI/180),d=Math.cos(c),u=Math.sin(c),p=t-l,b=e-i,x=p*d+b*u,m=-p*u+b*d,g=a/2,y=r/2;return x>=-g&&x<=g&&m>=-y&&m<=y},P=t=>t===0&&1/t===-1/0;class ql extends se{constructor({x:o,y:s,fillColor:l,enableFill:i=!0,width:a,height:r,...c}){super(c);h(this,"x");h(this,"y");h(this,"width");h(this,"height");h(this,"fillColor");h(this,"enableFill");this.x=o,this.y=s,this.width=a,this.height=r,this.fillColor=l,this.enableFill=i}getDetails(){return{...this.getSize(),fillColor:this.fillColor,enableFill:this.enableFill,x:this.x,y:this.y,width:this.width,height:this.height,...super.getDetails()}}getSize(){return{width:0,height:0}}getBoundingRect(){const{x:o,y:s,width:l,height:i,rotation:a}=this,r=o-l/2,c=s-i/2;return a===0?{x:r,y:c,width:l,height:i,left:r,top:c,right:r+l,bottom:c+i,centerX:o,centerY:s}:Gl({x:r,y:c,width:l,height:i},a)}}class Ql extends ql{constructor({...e}){super(e)}getDetails(){return super.getDetails()}getBoundingRect(){return super.getBoundingRect()}}function I(t,e={}){if(typeof t!="object"||t===null)return t;if(Array.isArray(t))return t.map(s=>I(s,e));const o=Object.create(e.clonePrototype?Object.getPrototypeOf(t):null);for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=I(t[s],e));return o}class Jl{constructor(e){h(this,"lock");h(this,"editor");h(this,"eventsMap",new Map([["selectAll",[]],["copy",[]],["paste",[]],["duplicate",[]],["delete",[]],["escape",[]],["modifyModules",[]],["undo",[]],["redo",[]]]));this.editor=e,this.lock=!1}subscribe(e,o){this.eventsMap.has(e)?this.eventsMap.get(e).push(o):this.eventsMap.set(e,[o])}unsubscribe(e,o){if(this.eventsMap.has(e)){const s=this.eventsMap.get(e);for(let l=s.length-1;l>=0;l--)if(s[l]===o)return s.splice(l,1),"deleted";return"Cannot find event or function"}}dispatcher(e,o){if(this.lock)return;const s=5;switch(this.lock=!0,e){case"selectAll":this.editor.selectionManager.selectAll();break;case"select":this.editor.selectionManager.replace(o);break;case"copy":this.editor.selectionManager.copySelected();break;case"delete":this.editor.selectionManager.removeSelected();break;case"duplicate":this.editor.selectionManager.duplicateSelected();break;case"escape":this.editor.selectionManager.clear();break;case"paste":this.editor.selectionManager.pasteCopied();break;case"redo":this.editor.history.redo();break;case"undo":this.editor.history.undo();break;case"zoom":this.editor.viewport.zoomTo(o);break;case"moveUp":case"moveRight":case"moveDown":case"moveLeft":this.editor.batchMove(this.editor.selectionManager.getSelected(),{x:e==="moveLeft"&&-5||e==="moveRight"&&s||0,y:e==="moveUp"&&-5||e==="moveDown"&&s||0},"move");break;default:console.warn(`Unknown code: ${e}`)}this.eventsMap.has(e)&&this.eventsMap.get(e).forEach(l=>{l()}),this.lock=!1}destroy(){this.eventsMap.clear(),this.editor=null,this.lock=!1}}class ei extends se{constructor({start:o,end:s,...l}){super(l);h(this,"start");h(this,"end");this.start=o,this.end=s}getDetails(){return{...this.getSize(),...super.getDetails()}}getSize(){return{width:100,height:100}}getBoundingRect(){const{x:o,y:s}={x:0,y:1},{width:l,height:i}=this.getSize();return{x:o,y:s,width:l,height:i,top:s,left:o,right:o+l,bottom:s+i}}}function ti(t){var o,s;this.batchCreate(t).forEach(l=>{console.log(this.moduleMap),this.moduleMap.set(l.id,l)}),this.render(),(s=(o=this.events).onModulesUpdated)==null||s.call(o,this.moduleMap),this.selectionManager.render()}const le=t=>{if(!Array.isArray(t))return[];const e=new Set;return t.filter(o=>{const s=Object.keys(o).sort().map(l=>`${l}:${String(o[l])}`).join(";");return e.has(s)?!1:(e.add(s),!0)})},ie=(t,e)=>{let o=e;o.length>1e3&&(o=e.map(l=>({...l,x:Math.floor(l.x),y:Math.floor(l.y)})));const s=le(o);t.save(),s.forEach(({x:l,y:i,width:a,height:r,fillColor:c="",lineColor:d="",lineWidth:u=1,radius:p=0,opacity:b=100,gradient:x,rotation:m=0,dashLine:g=""})=>{const y=a/2,v=r/2;t.save(),t.translate(l,i),m>0&&t.rotate(m*Math.PI/180),b>0&&(t.fillStyle=c,t.globalAlpha=b/100),u>0&&(t.lineWidth=u,t.strokeStyle=d,t.lineJoin="round"),t.beginPath(),g&&t.setLineDash([3,5]),p>0?(t.moveTo(-y+p,-v),t.arcTo(y,-v,y,v,p),t.arcTo(y,v,-y,v,p),t.arcTo(-y,v,-y,-v,p),t.arcTo(-y,-v,y,-v,p)):t.rect(-y,-v,a,r),t.closePath(),b>0&&t.fill(),u>0&&t.stroke(),t.restore()})},oi=(t,e)=>{const o=new Set,s=",";t.save(),e.forEach(r=>{const c=Object.values(r).join(s);o.add(c)});let l=NaN,i="";const a=new Path2D;o.forEach(r=>{const c=r.split(s),d=parseFloat(c[0]),u=parseFloat(c[1]),p=parseFloat(c[2]),b=parseFloat(c[3]),x=c[4],m=parseFloat(c[5]);m!==l&&(t.lineWidth=m,l=m),x!==i&&(t.fillStyle=x,i=x),a.moveTo(d,u),a.lineTo(p,b)}),t.stroke(a),t.restore()},si=({ctx:t,modules:e,frame:o})=>{const l=[{...o,x:o.cx,y:o.cy}],i=[],a=[];e.forEach(r=>{if(r.type==="rectangle"){const{x:c,y:d,width:u,height:p,enableFill:b,enableLine:x,opacity:m,lineWidth:g,fillColor:y,lineColor:v,rotation:C,gradient:N,radius:M,id:k}=r.getDetails();(b&&m>0||x)&&l.push({x:c,y:d,width:u,height:p,fillColor:y,opacity:m,lineWidth:g,lineColor:v,rotation:C,gradient:N,radius:M}),a.push({x:c+10,y:d+10,width:u,height:p,id:k.match(/\d+$/g)[0]})}if(r.type==="connector"){const c=e.get(r.start),d=e.get(r.end),u=c.getBoundingRect(),p=d.getBoundingRect();i.push({startX:u.centerX,startY:u.bottom,endX:p.centerX,endY:p.top,fillStyle:"#5491f8",lineWidth:1})}}),ie(t,l),oi(t,i),li(t,a)},li=(t,e)=>{t.font="sans-serif",t.textBaseline="top",e.forEach(({id:o,x:s,y:l,width:i,height:a})=>{t.fillText(o,s-i/2+5,l-a/2+5,100)})};function ii(){const t="#1FB3FF",e="rgba(31,180,255,0.1)";this.editor.container.innerHTML="",this.mainCanvas.setAttribute("editor-main-canvas",""),this.mainCanvas.style.backgroundColor="#f0f0f0",this.mainCanvas.style.position="absolute",this.mainCanvas.style.left="0",this.mainCanvas.style.top="0",this.mainCanvas.style.width="100%",this.mainCanvas.style.height="100%",this.mainCanvas.style.pointerEvents="none",this.selectionCanvas.setAttribute("editor-selection-canvas",""),this.selectionCanvas.style.position="absolute",this.selectionCanvas.style.left="0",this.selectionCanvas.style.top="0",this.selectionCanvas.style.width="100%",this.selectionCanvas.style.height="100%",this.selectionCanvas.style.pointerEvents="none",this.wrapper.setAttribute("editor-wrapper",""),this.wrapper.style.userSelect="none",this.wrapper.style.position="relative",this.wrapper.style.scrollbarWidth="thin",this.wrapper.style.scrollbarColor="#787878 transparent",this.wrapper.style.overflow="hidden",this.wrapper.style.width="100%",this.wrapper.style.height="100%",this.selectionBox.setAttribute("editor-selection-box",""),this.selectionBox.style.pointerEvents="none",this.selectionBox.style.position="absolute",this.selectionBox.style.border="1px solid "+t,this.selectionBox.style.backgroundColor=e,ne(this.scrollBarX,this.scrollBarY),H(this.selectionBox,{x:0,y:0,width:0,height:0},!1),this.wrapper.append(this.mainCanvas,this.selectionCanvas,this.scrollBarX,this.scrollBarY,this.selectionBox),this.editor.container.appendChild(this.wrapper)}const ni=()=>{const t=document.createElement("div"),e=document.createElement("div");return t.setAttribute("scroll-bar-x",""),e.setAttribute("scroll-bar-y",""),t.style.backgroundColor="#787878",e.style.backgroundColor="#787878",t.style.userSelect="none",e.style.userSelect="none",e.style.translate="none",e.style.translate="none",{scrollBarX:t,scrollBarY:e}},ne=(t,e)=>{t.style.width="50px",t.style.height="6px",t.style.position="absolute",t.style.bottom="0",t.style.left="0",e.style.width="6px",e.style.height="50px",e.style.position="absolute",e.style.right="0",e.style.top="0"},H=(t,{x:e,y:o,height:s,width:l},i=!0)=>{t.style.transform=`translate(${e}px, ${o}px)`,t.style.width=l+"px",t.style.height=s+"px",t.style.display=i?"block":"none"};function ai(t){const e=t.target===this.wrapper,o=t.button===0;if(!(!e||!o||this.domResizing))if(this.mouseDownPoint.x=t.clientX-this.rect.x,this.mouseDownPoint.y=t.clientY-this.rect.y,this.spaceKeyDown)this.manipulationStatus="panning";else if(this.hoveredModules.size>0){const s=[...this.hoveredModules][this.hoveredModules.size-1];this.editor.selectionManager.isSelectAll?this.editor.moduleMap.forEach(l=>{this.handlingModules.add(l.id)}):this.editor.selectionManager.selectedModules.has(s)?this.editor.selectionManager.selectedModules.forEach(l=>{this.handlingModules.add(l)}):this.handlingModules.add(s)}else this.manipulationStatus="selecting",t.ctrlKey||t.shiftKey||t.metaKey||this.editor.selectionManager.clear()}function ri(t){if(!this.domResizing)switch(this.mouseMovePoint.x=t.clientX-this.rect.x,this.mouseMovePoint.y=t.clientY-this.rect.y,this.hoveredModules.clear(),this.drawCrossLine=!1,this.manipulationStatus){case"selecting":{this.wrapper.setPointerCapture(t.pointerId);const e=q(this.mouseDownPoint,this.mouseMovePoint),o=this.screenToCanvas(e.x,e.y),s=this.screenToCanvas(e.x+e.width,e.y+e.height),l=q(o,s),i=new Set;this.editor.visibleModuleMap.forEach(a=>{if(a.type==="rectangle"){const r=a.getBoundingRect();Wl(r,l)&&i.add(a.id)}}),t.ctrlKey||t.shiftKey||t.metaKey?this.editor.selectionManager.toggle(i):this.editor.selectionManager.replace(i),H(this.selectionBox,e),this.resetSelectionCanvas(),this.renderSelectionCanvas()}break;case"panning":this.translateViewport(t.movementX,t.movementY);break;case"dragging":{this.wrapper.setPointerCapture(t.pointerId);const e=t.movementX*this.dpr/this.scale,o=t.movementY*this.dpr/this.scale;this.handlingModules.forEach(s=>{this.editor.moduleMap.get(s).x+=e,this.editor.moduleMap.get(s).y+=o}),this.editor.updateVisibleModuleMap(this.virtualRect),this.render()}break;case"resizing":break;case"rotating":break;case"static":{const o=Math.abs(this.mouseMovePoint.x-this.mouseDownPoint.x)>10||Math.abs(this.mouseMovePoint.y-this.mouseDownPoint.y)>10;if(this.handlingModules.size>0&&o)this.manipulationStatus="dragging";else{const s=this.screenToCanvas(this.mouseMovePoint.x,this.mouseMovePoint.y);this.editor.visibleModuleMap.forEach(l=>{if(l.type==="rectangle"){const{x:i,y:a,width:r,height:c,rotation:d}=l;Zl(s,{x:i,y:a,width:r,height:c},d)&&this.hoveredModules.add(l.id)}}),this.wrapper.releasePointerCapture(t.pointerId),this.drawCrossLine=this.drawCrossLineDefault,this.updateVirtualRect(),this.resetSelectionCanvas(),this.renderSelectionCanvas()}}break}}const ci=(t,e,o,s,l)=>{const i=o/2,a=s/2,r=l*(Math.PI/180),c=Math.cos(r),d=Math.sin(r);return[{x:t-i,y:e-a},{x:t,y:e-a},{x:t+i,y:e-a},{x:t+i,y:e},{x:t+i,y:e+a},{x:t,y:e+a},{x:t-i,y:e+a},{x:t-i,y:e}].map(({x:p,y:b})=>{const x=p-t,m=b-e;return{x:t+x*c-m*d,y:e+x*d+m*c}})};function ae(t,e,o,s,l){return{x:(s-e)/t,y:(l-o)/t}}const di=({ctx:t,mousePoint:e,scale:o,dpr:s,offset:{x:l,y:i},virtualRect:{left:a,top:r,right:c,bottom:d}})=>{const u=10/(s*o),p=10/(s*o),{x:b,y:x}=ae(o,l*s,i*s,e.x*s,e.y*s),m="#ff0000",g="#ff0000",y="#000";t.save(),t.textBaseline="alphabetic",t.font=`${24/o}px sans-serif`,t.fillStyle=g,t.shadowColor=m,t.shadowBlur=1,t.fillText(`${Math.floor(b)}, ${Math.floor(x)}`,b+u,x-p,200/o),t.lineWidth=2/(s*o),t.strokeStyle=m,t.shadowColor=y,t.shadowBlur=0,t.beginPath(),t.moveTo(a,x),t.lineTo(c,x),t.moveTo(b,r),t.lineTo(b,d),t.stroke(),t.restore()},hi=t=>{if(F(t)==="set")return new Set([...t]);throw new Error("Unsupported type: Not a Set")};function ui(t){const e=t.clientX-this.rect.x,o=t.clientY-this.rect.y;switch(this.mouseMovePoint.x=e,this.mouseMovePoint.y=o,this.manipulationStatus){case"selecting":this.resetSelectionCanvas(),this.renderSelectionCanvas();break;case"panning":break;case"dragging":{const s=(this.mouseMovePoint.x-this.mouseDownPoint.x)*this.dpr/this.scale,l=(this.mouseMovePoint.y-this.mouseDownPoint.y)*this.dpr/this.scale;this.handlingModules.forEach(i=>{this.editor.moduleMap.get(i).x-=s,this.editor.moduleMap.get(i).y-=l}),this.editor.batchMove(hi(this.handlingModules),{x:s,y:l},"move"),this.editor.selectionManager.replace(this.handlingModules)}break;case"resizing":break;case"rotating":break;case"static":t.ctrlKey||t.metaKey||t.shiftKey?this.editor.selectionManager.toggle(this.handlingModules):this.editor.selectionManager.replace(this.handlingModules);break}this.handlingModules.clear(),this.manipulationStatus="static",H(this.selectionBox,{x:0,y:0,width:0,height:0},!1)}function pi(t){if(!(this.manipulationStatus==="panning"||this.manipulationStatus==="selecting")&&t.code==="Space"){this.spaceKeyDown=!0,this.wrapper.style.cursor="grabbing",t.preventDefault();return}}function fi(t){t.code==="Space"&&(this.spaceKeyDown=!1,this.wrapper.style.cursor="default")}function bi(t){if(t.target!==this.wrapper)return;t.preventDefault(),t.stopPropagation();const{zooming:e,panning:o,scrolling:s,zoomFactor:l,translateX:i,translateY:a}=gi(t);this.zooming=e,e?(console.log(l),this.zoomAtPoint(this.mouseMovePoint,l)):(o||s)&&this.translateViewport(i,a),this.updateVirtualRect()}const gi=(()=>{let t;const s=[];let l=!1,i=!1,a=!1,r=0,c=0,d=0,u=!1;const p=.01,b=.1;return x=>{const{deltaX:m,deltaY:g,altKey:y}=x;if(t&&clearTimeout(t),u?s.length=0:s.push(x),c=0,d=0,l=!1,a=!1,i=!1,y&&(l=!0),s.length>=3){const v=s.every(M=>P(M.deltaX)),C=s.every(M=>O(M.deltaY)),N=s.every(M=>Math.abs(M.deltaY)>4);v&&C&&!N&&(u=!0,console.log("touchpadZoomingLock"))}return u?(r=g>0?-.01:p,l=!0):Math.abs(m)>=40&&P(g)?y?r=m<0?b:-.1:(a=!0,c=-m):P(m)&&O(g)&&Math.abs(g)>4?y?r=g<0?p:-.01:(a=!0,d=-g):Q(m)&&Q(g)&&(y?r=(Math.abs(m)>Math.abs(g)?m:g)<0?p:-.01:(i=!0,c=-m,d=-g)),l&&y&&(r=r<0?-.1:b),t=setTimeout(()=>{u=!1,l=!1,i=!1,a=!1,r=0,c=0,d=0,s.length=0},200),{zooming:l,panning:i,scrolling:a,zoomFactor:r,translateX:c,translateY:d}}})();function Q(t){return!O(t)}function O(t){return Math.abs(t)%1!==0}function mi(t){const e="editor-contextmenu-dom",o=document.createElement("div"),s=()=>{window.removeEventListener("mousedown",s),o.remove()};window.addEventListener("mousedown",s),o.dataset.name=e,o.style.position="fixed",o.style.top=t.clientY+"px",o.style.left=t.clientX+"px",o.style.backgroundColor="#dfdfdf",o.style.padding="10px 10px",o.style.width="200px",o.style.height="auto",o.style.boxShadow="rgb(194 194 194) 0px 0px 1px 1px",o.innerHTML=`
    <div>
      <div>Undo</div>
      <div>Redo</div>
      <div>Paste</div>
      <div>Select All</div>
    </div>
  `,this.wrapper.append(o),t.preventDefault(),t.stopPropagation()}const J=(t,e,o,{x:s,y:l})=>{const i=[o,0,0,o,s*e,l*e];t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width*2,t.canvas.height*2),t.setTransform(...i)},xi=(t,e)=>{let o=e;o.length>1e3&&(o=e.map(l=>({...l,x:Math.floor(l.x),y:Math.floor(l.y)})));const s=le(o);t.save(),s.forEach(({x:l,y:i,r1:a,r2:r,fillColor:c="",lineColor:d="",lineWidth:u=1,opacity:p=100,gradient:b,rotation:x=0,dashLine:m=""})=>{t.save(),t.translate(l,i),x!==0&&t.rotate(x*Math.PI/180),p>0&&(t.fillStyle=c,t.globalAlpha=p/100),u>0&&(t.lineWidth=u,t.strokeStyle=d,t.lineJoin="round"),t.beginPath(),t.ellipse(0,0,a,r,0,0,Math.PI*2),m?t.setLineDash([3,5]):t.setLineDash([]),t.closePath(),p>0&&t.fill(),u>0&&t.stroke(),b&&(t.fillStyle=b,p>0&&t.fill()),t.restore()})};function yi(){const{selectionCTX:t,editor:e,dpr:o,offset:s,virtualRect:l,scale:i,mouseMovePoint:a}=this,{selectionManager:r}=e;r.selectedModules.size;const c=d=>{const u=r.resizeHandleSize/2,p=[],b=[],x="#5491f8",m="#5491f8";d.forEach(g=>{const{x:y,y:v,width:C,height:N,rotation:M,lineWidth:k}=g.getDetails(),D=ci(y,v,C,N,M);b.push(...D.map(R=>({...R,r1:u,r2:u,fillColor:x,lineColor:"#fff"}))),p.push({x:y,y:v,width:C,height:N,fillColor:x,lineColor:m,lineWidth:k,rotation:M,opacity:0,dashLine:"dash"})}),ie(t,p),xi(t,b),this.enableCrossLine&&this.drawCrossLine&&di({ctx:t,mousePoint:a,scale:i,dpr:o,offset:s,virtualRect:l})};if(r.isSelectAll)c(r.editor.visibleModuleMap);else{const d=new Map;r.selectedModules.forEach(u=>{r.editor.visibleModuleMap.forEach(p=>{p.id===u&&d.set(p.id,p)})}),c(d)}}const vi=(t,e)=>{const{width:o,height:s}=e,{width:l,height:i}=t,a=.98,r=o/l,c=s/i,d=Math.min(r,c)*a,u=((o-l*d)/2-t.x*d)/2,p=((s-i*d)/2-t.y*d)/2;return{scale:d,offsetX:u,offsetY:p}},wi=(t="A4")=>{let e=0,o=0;const s=0,l=0;if(t==="A4"||t==="A4L"){const a=1.414142857;t==="A4L"?(o=1e3,e=a*o):(e=1e3,o=a*e)}else t==="photo1"&&(e=35,o=55);return{...Y({x:s,y:l,width:e,height:o}),opacity:100,lineWidth:1,lineColor:"#000000",fillColor:"#fff"}},Ci=(t,e,o,s)=>({x:t,y:e,width:o,height:s,left:t,top:e,right:t+o,bottom:e+s,cx:t+o/2,cy:e+s/2});class Mi{constructor(e){h(this,"editor");h(this,"resizeInterval",17);h(this,"resizeObserver");h(this,"wrapper");h(this,"scrollBarX");h(this,"scrollBarY");h(this,"selectionBox");h(this,"selectionCanvas");h(this,"selectionCTX");h(this,"mainCanvas");h(this,"mainCTX");h(this,"eventsController");h(this,"initialized",!1);h(this,"dpr",2);h(this,"spaceKeyDown",!1);h(this,"hoveredModules",new Set);h(this,"handlingModules",new Set);h(this,"zooming",!1);h(this,"manipulationStatus","static");h(this,"frame",wi("A4"));h(this,"mouseDownPoint",{x:0,y:0});h(this,"mouseMovePoint",{x:0,y:0});h(this,"offset",{x:0,y:0});h(this,"rect");h(this,"virtualRect",{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0,cx:0,cy:0});h(this,"domResizing",!1);h(this,"resizeTimeout");h(this,"scale",1);h(this,"enableCrossLine",!0);h(this,"drawCrossLineDefault",!1);h(this,"drawCrossLine",!1);const{scrollBarX:o,scrollBarY:s}=ni(),l=document.createElement("canvas"),i=document.createElement("canvas"),a=l.getContext("2d"),r=i.getContext("2d");this.selectionCanvas=l,this.mainCanvas=i,this.selectionCTX=a,this.mainCTX=r,this.editor=e,this.scrollBarX=o,this.scrollBarY=s,this.selectionBox=document.createElement("div"),this.wrapper=document.createElement("div"),this.resizeThrottle=this.resizeThrottle.bind(this),this.resizeObserver=new ResizeObserver(this.resizeThrottle),this.updateCanvasSize=this.updateCanvasSize.bind(this),this.eventsController=new AbortController,this.init()}init(){this.updateCanvasSize(),ii.call(this),this.resizeObserver.observe(this.editor.container),this.setupEvents()}setupEvents(){const{signal:e}=this.eventsController;window.addEventListener("mousedown",ai.bind(this),{signal:e}),window.addEventListener("mouseup",ui.bind(this),{signal:e}),window.addEventListener("keydown",pi.bind(this),{signal:e}),window.addEventListener("keyup",fi.bind(this),{signal:e}),window.addEventListener("wheel",bi.bind(this),{signal:e,passive:!1}),this.wrapper.addEventListener("pointermove",ri.bind(this),{signal:e}),this.wrapper.addEventListener("contextmenu",mi.bind(this),{signal:e})}updateVirtualRect(){var d,u;const{x:e,y:o}=this.screenToCanvas(0,0),{x:s,y:l}=this.screenToCanvas(this.rect.width,this.rect.height),{x:i,y:a}=this.screenToCanvas(this.mouseMovePoint.x,this.mouseMovePoint.y),r=s-e,c=l-o;this.virtualRect={x:e,y:o,width:r,height:c,cx:e+r/2,cy:o+c/2,top:o,right:s,bottom:l,left:e},this.editor.updateVisibleModuleMap(this.virtualRect),(u=(d=this.editor.events).onViewportUpdated)==null||u.call(d,{offsetX:this.offset.x,offsetY:this.offset.y,scale:this.scale,dx:i,dy:a,status:this.manipulationStatus,width:r,height:c})}zoomAtPoint(e,o,s=!1){const{offset:l,scale:i,dpr:a}=this,r=.1,c=5;let d=i+o;const u=e.x*i,p=e.y*i,b={x:0,y:0,width:this.rect.width*a,height:this.rect.height*a};if(console.log(u,p,b),s&&(d=o),d<r||d>c)return;const x=Math.max(r,Math.min(c,d)),m=x/i,g=this.screenToCanvas(e.x,e.y),y=g.x-(g.x-l.x)*m,v=g.y-(g.y-l.y)*m;this.scale=x,this.offset.x=y,this.offset.y=v,this.render(),this.updateVirtualRect()}zoomTo(e){console.log(e),e==="fit"?this.fitFrame():this.zoomAtPoint({x:this.rect.width/2,y:this.rect.height/2},e,!0)}setTranslateViewport(e,o){this.offset.x=0,this.offset.y=0,this.translateViewport(e,o)}translateViewport(e,o){this.offset.x+=e,this.offset.y+=o,this.updateVirtualRect(),this.render()}updateScrollBar(){const{scrollBarX:e,scrollBarY:o}=this;ne(e,o)}resizeThrottle(){clearTimeout(this.resizeTimeout),this.domResizing=!0,this.resizeTimeout=setTimeout(this.onResize.bind(this),this.resizeInterval)}onResize(){this.domResizing=!1,this.updateCanvasSize(),this.updateVirtualRect(),this.render(),this.initialized||(this.initialized=!0,this.fitFrame())}updateCanvasSize(){this.rect=this.editor.container.getBoundingClientRect(),this.mainCanvas.width=this.rect.width*this.dpr,this.mainCanvas.height=this.rect.height*this.dpr,this.selectionCanvas.width=this.rect.width*this.dpr,this.selectionCanvas.height=this.rect.height*this.dpr}screenToCanvas(e,o){const{dpr:s,offset:l,scale:i}=this;return ae(i,l.x*s,l.y*s,e*s,o*s)}fitFrame(){const{dpr:e,frame:o,rect:s}=this,l=Ci(0,0,s.width*e,s.height*e),{scale:i,offsetX:a,offsetY:r}=vi(o,l);this.scale=i,this.offset.x=a,this.offset.y=r,this.render(),this.updateVirtualRect()}resetMainCanvas(){J(this.mainCTX,this.dpr,this.scale,this.offset)}resetSelectionCanvas(){J(this.selectionCTX,this.dpr,this.scale,this.offset)}renderMainCanvas(){requestAnimationFrame(()=>{si({ctx:this.mainCTX,frame:this.frame,modules:this.editor.visibleModuleMap})})}renderSelectionCanvas(){requestAnimationFrame(()=>{yi.call(this)})}render(){this.resetMainCanvas(),this.resetSelectionCanvas(),this.renderMainCanvas(),this.renderSelectionCanvas()}destroy(){clearTimeout(this.resizeTimeout),this.resizeObserver.disconnect(),this.eventsController.abort(),this.wrapper.style.width="100%",this.wrapper.style.height="100%",this.wrapper.remove(),this.editor.container.innerHTML=""}}class Si{constructor({container:e,data:o,dpr:s=2,events:l={}}){h(this,"moduleCounter",0);h(this,"moduleMap");h(this,"visibleModuleMap");h(this,"id");h(this,"container");h(this,"events",{});h(this,"action");h(this,"history");h(this,"selectionManager");h(this,"viewport");h(this,"zoom");h(this,"scale",1);this.moduleMap=o.modules.reduce((i,a)=>(i.set(a.id,a),i),new Map),this.visibleModuleMap=new Map,this.id=o.id,this.scale=s,this.events=l,this.container=e,this.viewport=new Mi(this),this.action=new Jl(this),this.selectionManager=new Yl(this),this.history=new _l(this)}createModuleId(){return this.id+"-"+ ++this.moduleCounter}batchCreate(e){const o=I(e),s=new Map,l=i=>{if(i.id||(i.id=this.createModuleId()),i.type==="rectangle")return new Ql(i);if(i.type==="connector")return new ei(i)};return o.forEach(i=>{const a=l.call(this,i);s.set(i.id,a)}),s}batchAdd(e,o){var s,l;if(e.forEach(i=>{this.moduleMap.set(i.id,i)}),this.updateVisibleModuleMap(this.viewport.virtualRect),(l=(s=this.events).onModulesUpdated)==null||l.call(s,this.moduleMap),this.render(),o){const i=[...e.values()].map(a=>a.getDetails());this.selectionManager.getSelected(),this.history.add({type:o,payload:{modules:i,selectedModules:this.selectionManager.getSelected()}})}}batchCopy(e,o=!1,s){const l=[];let i=new Map;return e==="all"?i=this.moduleMap:F(e)==="set"&&e.forEach(a=>{const r=this.moduleMap.get(a);r&&i.set(a,r)}),i.forEach(a=>{const r=a.getDetails();o&&delete r.id,F(s)==="object"&&Object.assign(r,s),l.push(r)}),l}batchDelete(e,o){var l,i;let s=[];return e==="all"?(s=this.batchCopy("all"),this.moduleMap.clear()):F(e)==="set"&&(s=this.batchCopy(e),s.forEach(a=>{this.moduleMap.delete(a.id)})),o&&this.history.add({type:"delete",payload:{modules:s,selectedModules:this.selectionManager.getSelected()}}),this.updateVisibleModuleMap(this.viewport.virtualRect),this.render(),(i=(l=this.events).onModulesUpdated)==null||i.call(l,this.moduleMap),s}batchMove(e,o,s){var i,a,r,c;let l=null;if(e==="all")l=this.moduleMap;else if(F(e)==="set")l=this.getModulesByIdSet(e);else return!1;l.forEach(d=>{d.x+=o.x,d.y+=o.y}),this.render(),(a=(i=this.events).onModulesUpdated)==null||a.call(i,this.moduleMap),(c=(r=this.events).onSelectionUpdated)==null||c.call(r,this.selectionManager.selectedModules,this.selectionManager.getIfUnique()),s&&this.history.add({type:"move",payload:{delta:o,selectedModules:e}})}batchModify(e,o,s){var i,a,r,c;let l=null;if(e==="all")l=this.moduleMap;else if(F(e)==="set")l=this.getModulesByIdSet(e);else return!1;l.forEach(d=>{Object.keys(o).forEach(u=>{const p=o[u];(typeof p=="string"||typeof p=="number")&&(d[u]=p)})}),this.render(),(a=(i=this.events).onModulesUpdated)==null||a.call(i,this.moduleMap),(c=(r=this.events).onSelectionUpdated)==null||c.call(r,this.selectionManager.selectedModules,this.selectionManager.getIfUnique())}batchReplaceModules(e){ti.bind(this,e)}getModulesByLayerIndex(){}getModulesByIdSet(e){const o=new Map;return e.forEach(s=>{const l=this.moduleMap.get(s);l&&o.set(s,l)}),o}getModuleList(){return[...Object.values(this.moduleMap)]}updateVisibleModuleMap(e){this.visibleModuleMap.clear(),this.moduleMap.forEach(o=>{const s=o.getBoundingRect();Kl(s,e)&&this.visibleModuleMap.set(o.id,o)})}execute(e,o=null){this.action.dispatcher(e,o)}render(){this.viewport.render()}destroy(){this.action.destroy(),this.selectionManager.destroy(),this.history.destroy(),this.viewport.destroy(),this.moduleMap.clear(),this.action=null,this.selectionManager=null,this.crossLine=null,this.history=null,this.moduleMap=null,this.canvas=null,this.ctx=null,this.zoom=null,this.id=null,this.events=null,this.container=null}}const j=f.createContext({focused:!1,historyArray:[],historyCurrent:0,selectedModules:[],selectedProps:{},editorRef:{},applyHistoryNode:()=>{},executeAction:()=>{},viewport:{width:0,height:0,offsetX:0,offsetY:0,scale:1,dx:0,dy:0,status:""}}),Ni=()=>{const{executeAction:t,focused:e}=f.useContext(j),o=s=>{let l=null;const{key:i,ctrlKey:a,metaKey:r,shiftKey:c}=s,d={ArrowUp:"moveUp",ArrowDown:"moveDown",ArrowLeft:"moveLeft",ArrowRight:"moveRight"};i==="a"&&(a||r)&&(l="selectAll"),i==="c"&&(a||r)&&!c&&(l="copy"),i==="v"&&(a||r)&&(l="paste"),i==="d"&&(a||r)&&(l="duplicate"),(i==="Delete"||i==="Backspace")&&(l="delete"),i==="Escape"&&(l="escape"),i==="z"&&(a||r)&&(l="undo"),i==="z"&&c&&(a||r)&&(l="redo"),d[i]&&(l=d[i]),l&&(t(l),s.stopPropagation(),s.preventDefault())};return f.useEffect(()=>{if(e)return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[e]),null},ji=[{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50},{type:"rectangle",width:100,height:50}],Fi=()=>{const{editorRef:t}=f.useContext(j);return f.useEffect(()=>{t.current&&console.log("editorRef.current updated:",t.current)},[t]),n.jsx("div",{className:"flex flex-wrap space-x-2 space-y-2",children:ji.map((e,o)=>n.jsx("div",{className:"shrink-0 select-none cursor-move",style:{width:e.width,height:e.height,border:"1px solid #dfdfdf"},onMouseEnter:()=>{}},o))})},ki=({className:t=""})=>{const[e,o]=f.useState(300),s=f.useRef(!1),l=f.useRef(null),i=f.useCallback(c=>{c.preventDefault(),s.current=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[]),a=f.useCallback(c=>{if(!s.current)return;const d=window.innerWidth*.9,u=Math.min(Math.max(0,c.clientX),d);c.stopPropagation(),o(u)},[]),r=f.useCallback(c=>{s.current=!1,document.body.style.cursor="default",document.body.style.userSelect="",c.stopPropagation()},[]);return f.useEffect(()=>(window.addEventListener("mousemove",a),window.addEventListener("mouseup",r),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",r)}),[a,r]),n.jsxs("div",{ref:l,style:{width:`${e}px`},className:"relative h-full flex-shrink-0 border-r border-gray-200",children:[n.jsxs("div",{className:`h-auto p-6 bg-white overflow-hidden ${t}`,children:[n.jsx("span",{children:"Module List"}),n.jsx(Fi,{})]}),n.jsx("div",{className:"absolute z-10 top-0 -right-1 w-2 h-full bg-transparent hover:bg-gray-200 cursor-col-resize transition-colors",onMouseDown:i})]})},ee=t=>(t*100).toFixed(2)+"%",Ei=t=>{const e=t.replace("%","").trim(),o=Number(e);return isNaN(o)?!1:Number(o.toFixed(2))},Ti=({scale:t,onChange:e})=>{const o=[{label:"400%",value:4},{label:"300%",value:3},{label:"200%",value:2},{label:"150%",value:1.5},{label:"125%",value:1.25},{label:"100%",value:1},{label:"75%",value:.75},{label:"50%",value:.5},{label:"25%",value:.25},{label:"Fit window",value:"fit"}],[s,l]=f.useState(ee(1)),[i,a]=f.useState(!1),r=f.useRef(null);f.useEffect(()=>{const d=ee(t);r.current&&(r.current.value=d),l(d)},[t]);const c=d=>{if(d.key==="Enter"){const u=Ei(d.target.value);u!==!1&&e(u),r.current.blur()}d.stopPropagation()};return n.jsxs("div",{className:"w-17 h-5 ml-2 flex justify-start items-center relative  focus:ring-blue-500 focus:ring-1",children:[n.jsx("input",{type:"text",ref:r,onChange:void 0,defaultValue:s,onKeyDown:c,className:"w-20 h-5 text-sm bg-gray-100 text-center overflow-hidden ",placeholder:"Enter zoom %"}),n.jsx("button",{onClick:()=>a(!i),className:"text-gray-800 flex trasition items-center cursor-pointer",children:i?n.jsx(xe,{className:"w-5 h-5"}):n.jsx(ye,{className:"w-5 h-5"})}),i&&n.jsx("div",{className:"fixed w-full h-full",onClick:()=>{a(!1)}}),i&&n.jsx("div",{className:"absolute w-20 cursor-pointer py-2 left-0 bottom-5 bg-white shadow-lg max-h-40v overflow-y-auto z-10",children:o.map(({label:d,value:u})=>n.jsx("div",{onClick:()=>{a(!1),e(u)},className:"text-sm align-middle p-1 text-center hover:bg-blue-500 hover:text-white transition",children:u==="fit"?d:`${u*100}%`},u))})]})},$i=({className:t=""})=>{const{viewport:e,executeAction:o}=f.useContext(j);return e?n.jsx("footer",{className:t+"w-full h-8 flex justify-between pr-1 items-center border-t border-gray-200",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(Ti,{scale:e.scale,onChange:s=>{o("zoom",s)}},e.scale),n.jsx("div",{className:"text-xs line-clamp-1",children:`dx:${e.dx.toFixed(2)} dx:${e.dy.toFixed(2)}`})]})}):null},B=28,Li=({data:t,selected:e,handleSelectModule:o})=>{const s=f.useRef(null),l=f.useRef(null),[i,a]=f.useState(0),[r,c]=f.useState([0,10]);f.useEffect(()=>{},[e,t]);const d=()=>{if(!s.current)return;const p=s.current.scrollTop,b=p<i,x=Math.round(p/B),m=x+10;if(console.log(p),b){if(r[0]>=t.length-1)return}else if(r[1]>=t.length-1)return;a(p),c([x,m])},u=[];for(let p=r[0];p<r[1];p++){const b=t[p];b&&u.push(n.jsx("div",{ref:e!=null&&e.includes(b.id)?l:null,style:{height:B},className:e!=null&&e.includes(b.id)?"bg-gray-400 text-white":"",onClick:()=>o(b.id),id:`layer-module-${b.id}`,children:b.type},b.id))}return n.jsxs("div",{className:"p-2",children:[n.jsx("h1",{className:"bg-gray-400 text-white px-2",children:n.jsx("span",{children:"Layer"})}),n.jsx("div",{className:"p-2 relative overflow-hidden",children:n.jsxs("div",{ref:s,onScroll:d,className:"relative scrollbar-custom overflow-x-hidden overflow-y-auto p-2 border h-30 border-gray-200 select-none",children:[n.jsx("div",{className:"absolute w-full top-0 left-0",style:{height:t.length*B}}),n.jsx("div",{className:"w-full sticky top-0 left-0",children:u})]})})]})},re=({menu:t})=>{const{t:e}=$(),[o,s]=f.useState(!1),{executeAction:l}=f.useContext(j),i=()=>{console.log(t.id),!(t.children||o)&&(l(t.id),s(!1))},a=t.children&&t.children.length>0;return n.jsxs("div",{className:"relative h-8 hover:bg-gray-200 min-w-50",onClick:()=>i(),onMouseOver:r=>{s(!0),r.preventDefault()},onMouseLeave:()=>{s(!1)},children:[n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center whitespace-nowrap",children:[n.jsx("span",{children:e(t.id+".label")}),a&&n.jsx(ve,{size:18})]}),a&&o&&n.jsx("div",{className:"absolute bg-white z-30 left-full top-0 w-auto border border-gray-200 box-border",children:t.children.map(r=>n.jsx(re,{menu:r},r.id))})]})},Ai=()=>{const[t,e]=f.useState(!1),[o,s]=f.useState(null),{t:l}=$(),i=f.useRef(null),a=oe(c=>c.menu.actions),r=f.useMemo(()=>Di(a),[a]);return f.useEffect(()=>{const c=d=>{i.current.contains(d.target)||(e(!1),s(null))};return window.addEventListener("click",c),()=>{window.removeEventListener("click",c)}}),n.jsx("div",{className:"h-8 text-sm select-none border-gray-200 box-border",children:n.jsx("div",{ref:i,className:"pl-2 h-full inline-flex",children:r.map(c=>{var d;return n.jsxs("div",{className:"relative h-full",children:[n.jsx("div",{className:`h-full inline-flex items-center px-4 ${c.id===o?"bg-gray-200":""}`,onMouseEnter:()=>t&&s(c.id),onClick:()=>{o!==c.id?(e(!0),s(c.id)):(s(null),e(!1))},title:l(c.id+".tooltip"),children:n.jsx("span",{children:l(c.id+".label")})}),t&&c.id===o&&c.children.length>0&&n.jsx("div",{className:"absolute z-20 bg-white border border-gray-200",children:(d=c.children)==null?void 0:d.map(u=>n.jsx(re,{menu:u},u.id))})]},c.id)})})})};function Di(t){const e=new Map;Object.values(t).forEach(s=>{e.set(s.id,{...s,children:[]})});const o=[];return e.forEach(s=>{const l=e.get(s.parent);l?l.children.push(s):o.push(s)}),o}const L={strokeWidth:"2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},A="#9b9a9a",Ri=({size:t=24,...e})=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",...L,...e,children:[n.jsx("path",{fill:A,d:"M12,10.87l-9.06,5.67,9.06,5.67,9.06-5.67-9.06-5.67Z"}),n.jsx("path",{fill:"#fff",d:"M9.57,7.84c-2.21,1.38-4.42,2.76-6.64,4.15,3.02,1.89,6.04,3.78,9.06,5.67l9.06-5.67c-2.24-1.4-4.48-2.8-6.72-4.2"}),n.jsx("path",{d:"M11.96,1.8c.01,2.22.04,6.67.04,6.67M11.96,1.8c-1.87,1.12-3.75,2.25-5.62,3.37M12,1.8c2.09,1.3,3.4,2.13,5.55,3.47"})]}),zi=({size:t=24,...e})=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",...L,...e,children:[n.jsx("path",{fill:"#fff",d:"M14.43,16.16c2.21-1.38,4.42-2.76,6.64-4.15-3.02-1.89-6.04-3.78-9.06-5.67L2.94,12.02c2.24,1.4,4.48,2.8,6.72,4.2"}),n.jsx("path",{fill:"#fff",d:"M12.04,22.2c0-2.26-.02-4.52-.03-6.77M12.04,22.2c1.87-1.12,3.75-2.25,5.62-3.37M12,22.2c-2.09-1.3-3.4-2.13-5.55-3.47"}),n.jsx("path",{fill:A,d:"M12,13.13l9.06-5.67L12,1.8,2.94,7.46l9.06,5.67Z"})]}),Pi=({size:t=24,...e})=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",...L,...e,children:[n.jsx("path",{d:"M12,10.8l-9.65,6.03,9.65,6.03,9.65-6.03-9.65-6.03Z"}),n.jsx("path",{fill:"#fff",d:"M12,5.99L2.35,12.02l9.65,6.03,9.65-6.03-9.65-6.03Z"}),n.jsx("path",{fill:A,d:"M12,1.14L2.35,7.17l9.65,6.03,9.65-6.03L12,1.14Z"})]}),Bi=({size:t=24,...e})=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",...L,...e,children:[n.jsx("path",{fill:A,d:"M12,10.8l-9.65,6.03,9.65,6.03,9.65-6.03-9.65-6.03Z"}),n.jsx("path",{fill:"#fff",d:"M12,5.99L2.35,12.02l9.65,6.03,9.65-6.03-9.65-6.03Z"}),n.jsx("path",{fill:"#fff",d:"M12,1.14L2.35,7.17l9.65,6.03,9.65-6.03L12,1.14Z"})]}),Ii=({iconName:t,size:e})=>{switch(t){case"save":return n.jsx(Ee,{size:e});case"undo":return n.jsx(ke,{size:e});case"redo":return n.jsx(Fe,{size:e});case"trash":return n.jsx(je,{size:e});case"cross":return n.jsx(Ne,{size:e});case"group":return n.jsx(Se,{size:e});case"ungroup":return n.jsx(Me,{size:e});case"lock":return n.jsx(Ce,{size:e});case"unlock":return n.jsx(we,{size:e});default:return null}},E=20,T="text-black",Oi=()=>{const t=oe(o=>o.toolbar.actions),{executeAction:e}=f.useContext(j);return n.jsx("div",{className:"border-b border-gray-200 box-border",children:n.jsx("div",{className:"h-10 inline-flex pl-4 items-center",children:Object.values(t).map(o=>{const{id:s,icon:l,disabled:i,divide:a}=o;let r;switch(s){case"layerUp":r=n.jsx(Ri,{size:E,className:T});break;case"layerDown":r=n.jsx(zi,{size:E,className:T});break;case"layerTop":r=n.jsx(Pi,{size:E,className:T});break;case"layerBottom":r=n.jsx(Bi,{size:E,className:T});break;default:r=n.jsx(Ii,{size:E,iconName:l});break}return n.jsxs(f.Fragment,{children:[n.jsx("button",{type:"button",disabled:i,title:s,onClick:()=>{e(s)},className:"relative ml-1 rounded-sm mr-1 flex items-center cursor-pointer justify-center w-6 h-6 opacity-50   hover:bg-gray-200  hover:opacity-100 disabled:text-gray-200 disabled:cursor-default",children:r}),a&&n.jsx("div",{className:"w-[1px] h-4 bg-gray-400 mx-2"})]},s)})})})},Vi=()=>n.jsxs("header",{children:[n.jsx(Ai,{}),n.jsx(Oi,{})]}),Ui=()=>{const{historyArray:t,historyCurrent:e,applyHistoryNode:o}=f.useContext(j),{t:s}=$(),l=f.useRef(null);return f.useEffect(()=>{if(l.current)return()=>{}},[t,e]),n.jsxs("div",{className:"p-2",children:[n.jsx("h1",{className:"bg-gray-600 text-white px-2",children:n.jsx("span",{children:"History"})}),n.jsx("div",{className:"border h-50 border-gray-200 overflow-x-auto scrollbar-custom overflow-y-auto",children:n.jsx("div",{className:"flex flex-col m-2 border border-gray-200 min-h-40 bg-gray-100",children:t.map((i,a)=>{const r=i.id===e,c="history."+i.data.type,{label:d,tooltip:u}=s(c,{returnObjects:!0});return n.jsx("div",{title:u,ref:r?l:null,onClick:()=>{r||o(i)},className:` px-2 py-1 cursor-pointer text-xs hover:bg-gray-400 hover:text-white ${r?"bg-gray-400 text-white":""}`,children:n.jsx("span",{children:d})},a)})})})]})},Xi=()=>{const{selectedProps:t}=f.useContext(j);return f.useEffect(()=>{},[t]),n.jsxs("div",{className:"p-2",children:[n.jsx("h1",{className:"bg-gray-400 text-white px-2",children:n.jsx("span",{children:"Properties"})}),n.jsx("div",{className:"scrollbar-custom overflow-x-hidden overflow-y-auto p-2 border h-30 border-gray-200 select-none",children:t&&n.jsx(Yi,{props:t})})]})},Yi=({props:t})=>{const e=o=>{console.log(o)};return n.jsxs("div",{className:"z-30 text-sm",children:[n.jsxs("div",{className:"mb-4 ",children:[n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{className:"",children:"X:"}),n.jsx("input",{type:"number",name:"x",defaultValue:t.x,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{className:"",children:"Y:"}),n.jsx("input",{type:"number",name:"y",defaultValue:t.y,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{className:"",children:"Width:"}),n.jsx("input",{type:"number",name:"width",defaultValue:t.width,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Height:"}),n.jsx("input",{type:"number",name:"height",defaultValue:t.height,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Radius:"}),n.jsx("input",{type:"number",name:"radius",defaultValue:t.radius,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Enable Fill"}),n.jsx("input",{type:"checkbox",name:"enableFill",defaultChecked:t.enableFill,onChange:e,className:"ml-2"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Fill Color:"}),n.jsx("input",{type:"color",name:"fillColor",defaultValue:t.fillColor,onChange:e,className:"w-10 h-10 p-1 rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Enable Line"}),n.jsx("input",{type:"checkbox",name:"enableLine",defaultChecked:t.enableLine,onChange:e,className:"ml-2"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Line Color:"}),n.jsx("input",{type:"color",name:"lineColor",defaultValue:t.lineColor,onChange:e,className:"w-10 h-10 p-1 rounded"})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Shadow"}),n.jsx("input",{type:"checkbox",name:"shadow",defaultChecked:t.shadow,onChange:e,className:"ml-2"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Opacity:"}),n.jsx("input",{type:"number",name:"opacity",defaultValue:t.opacity,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]}),n.jsxs("div",{className:"px-4 w-full h-full flex justify-between items-center",children:[n.jsx("span",{children:"Layer:"}),n.jsx("input",{type:"number",name:"layer",defaultValue:t.layer,onChange:e,className:"w-16 px-2 py-1 text-black rounded"})]})]})]})},Hi=t=>{const s={type:"rectangle",x:100,y:100,width:100,height:100,enableLine:!0,lineColor:"#000000",lineWidth:1,enableFill:!0,fillColor:"#fff",opacity:100,shadow:!1,radius:0,rotation:0},l=2e4,i=10,a=Array.from({length:l}).map((c,d)=>({...s,fillColor:"#ed1c24",x:100+d*i,y:100+d*i,layer:d+1,rotation:d+10})),r=t.batchCreate(a);t.batchAdd(r,"add")},_i=({file:t})=>{const e=f.useRef(null),o=f.useRef(null),[s,l]=f.useState([]),[i,a]=f.useState([]),[r,c]=f.useState(null),[d,u]=f.useState([]),[p,b]=f.useState(0),[x,m]=f.useState({width:0,height:0,offsetX:0,offsetY:0,scale:1,dx:0,dy:0,status:""}),g=f.useRef(null),[y,v]=f.useState(!0);f.useEffect(()=>{let w;if(o.current){const z=U();w=new Si({container:o.current,data:{id:z,modules:[]},events:{onHistoryUpdated:k,onModulesUpdated:D,onSelectionUpdated:M,onViewportUpdated:R}}),Hi(w),e.current=w}const S=g.current;return S&&(S.addEventListener("focus",C),S.addEventListener("blur",N)),()=>{S&&(S.removeEventListener("focus",C),S.removeEventListener("blur",N)),w&&w.destroy()}},[t]);const C=()=>v(!0),N=()=>v(!1),M=(w,S)=>{u(Array.from(w)),c(S)},k=w=>{l(w.toArray()),w.current&&b(w.current.id)},D=w=>{const S=Array.from(w.values()).sort((z,pe)=>z.layer-pe.layer);a(S)},R=w=>{m(w)},ue=w=>{e.current&&e.current.history.moveCurrentToTargetById(w)},_=(w,S=null)=>{e.current.execute(w,S)};return n.jsx(j.Provider,{value:{focused:y,historyArray:s,selectedModules:d,selectedProps:r,historyCurrent:p,viewport:x,editorRef:e,applyHistoryNode:ue,executeAction:_},children:n.jsxs("div",{ref:g,"data-focused":y,autoFocus:!0,tabIndex:0,className:"outline-0 w-full h-full flex flex-col",children:[n.jsx(Ni,{}),n.jsx(Vi,{}),n.jsxs("main",{className:"flex flex-row overflow-hidden h-full",children:[n.jsx(ki,{}),n.jsxs("div",{className:"flex flex-col w-full h-full overflow-hidden",children:[n.jsx("div",{ref:o,"editor-container":"true",className:"relative overflow-hidden flex w-full h-full"}),n.jsx($i,{})]}),n.jsxs("div",{style:{width:200},className:"h-full flex-shrink-0 border-l border-gray-200",children:[n.jsx(Xi,{}),n.jsx(Li,{data:i,selected:d,handleSelectModule:w=>{_("select",new Set([w]))}}),n.jsx(Ui,{})]})]})]})})},Gi=t=>[],Ki=()=>{const t="Untitled 1",e={},o={modules:Gi()};return{id:U(),name:t,config:e,data:o}},Wi=t=>new Map(t.reduce((e,o)=>(e.push([o.id,o]),e),[])),Zi=Ki(),te=Wi([Zi]),qi=()=>{const t=' group py-2 px-6 relative transition flex items-center">',e=" bg-gray-200",o=" hover:bg-gray-200",{fileList:s,currentFileId:l,closeFile:i,switchFile:a,handleCreating:r}=f.useContext(X);return n.jsxs("div",{className:"flex flex-row items-center text-sm select-none",children:[s.map(c=>{const d=c.id===l,u=t+(d?e:o),p=(d?"visible":"invisible")+" w-2 h-2 ml-4 opacity-50 hover:opacity-100 group-hover:visible w-2 h-2 cursor-pointer";return n.jsxs("div",{className:u,onClick:()=>{a(c.id)},children:[n.jsx("span",{children:c.name}),n.jsx("span",{onClick:b=>{i(c.id),b.preventDefault(),b.stopPropagation()},className:p,children:"×"})]},c.id)}),n.jsx("button",{className:"hover:cursor-pointer hover:opacity-100 cursor-pointer opacity-50",children:n.jsx(Te,{size:18,onClick:()=>{r(!0)}})})]})},Qi=({children:t,defaultValue:e})=>{const[o,s]=f.useState(!1);return n.jsxs("div",{className:"relative w-20",children:[n.jsxs("div",{className:"flex items-center",onClick:()=>{s(!o)},children:[n.jsx($e,{}),e]}),o&&n.jsx("div",{onClick:()=>{s(!1)},className:"absolute top-full right-0 w-full",children:t})]})},Ji=()=>{const[t,e]=f.useState("en"),o={en:"English",cn:"中文",jp:"日本語"},{i18n:s}=$();return n.jsx("div",{className:"flex flex-row items-center text-sm select-none",children:n.jsx(Qi,{defaultValue:o[t],children:Object.keys(o).map((l,i)=>n.jsx("div",{onClick:()=>{s.changeLanguage(l),e(l)},children:o[l]},i))})})},en=()=>{const t=f.useRef(new Map),[e,o]=f.useState(!1),[s,l]=f.useState(""),[i,a]=f.useState([]),r=t.current.size,c=r===0||e;f.useEffect(()=>{te.size>0&&(t.current=te,d(),l(u()[0].id))},[]);const d=()=>{const g=u();return a(g),g},u=()=>Array.from(t.current.values()),p=g=>{l(g)},b=g=>{const y=i.findIndex(C=>C.id===g);let v=i.length;if(y!==-1&&(t.current.delete(g),d(),i.splice(y,1),v--,s===g&&v>0)){let C=y+1;y===0&&(C=0),C>v&&(C=v-1),l(i[C].id)}},x=g=>{t.current.set(g.id,g),d(),l(g.id)},m=g=>{o(g)};return n.jsx(X.Provider,{value:{fileMap:t.current,fileList:i,creating:e,currentFileId:s,switchFile:p,closeFile:b,createFile:x,handleCreating:m},children:n.jsxs("div",{className:"w-full h-full flex flex-col",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx(qi,{}),n.jsx(Ji,{})]}),n.jsx("div",{className:"flex-1 overflow-hidden min-h-[600px]",children:i.map(g=>g.id===s?n.jsx(_i,{file:g},g.id):void 0)}),c&&n.jsx(Xl,{bg:r?"#00000080":"#fff",onBgClick:()=>{r&&o(!1)}})]})})};function tn(){return n.jsx(en,{})}const on=[{id:"file",parent:null},{id:"newFile",parent:"file",shortcut:"Ctrl+N"},{id:"openFile",parent:"file",shortcut:"Ctrl+O"},{id:"saveFile",parent:"file",shortcut:"Ctrl+S"},{id:"saveAs",parent:"file"},{id:"importFile",parent:"file"},{id:"exportFile",parent:"file"},{id:"print",parent:"file"},{id:"closeFile",parent:"file"},{id:"exportFile_png",parent:"exportFile"},{id:"exportFile_pdf",parent:"exportFile"},{id:"exportFile_csv",parent:"exportFile"},{id:"edit",parent:null},{id:"undo",parent:"edit",shortcut:"Ctrl+Z"},{id:"redo",parent:"edit",shortcut:"Ctrl+Y"},{id:"cut",parent:"edit",shortcut:"Ctrl+X"},{id:"copy",parent:"edit",shortcut:"Ctrl+C"},{id:"paste",parent:"edit",shortcut:"Ctrl+V"},{id:"delete",parent:"edit",shortcut:"Del"},{id:"duplicate",parent:"edit",shortcut:"Ctrl+D"},{id:"selectAll",parent:"edit",shortcut:"Ctrl+A"},{id:"findReplace",parent:"edit",shortcut:"Ctrl+F"},{id:"view",parent:null},{id:"zoomIn",parent:"view",shortcut:"Ctrl++"},{id:"zoomOut",parent:"view",shortcut:"Ctrl+-"},{id:"fitToScreen",parent:"view"},{id:"toggleGrid",parent:"view"},{id:"toggleGuides",parent:"view"},{id:"fullscreenMode",parent:"view",shortcut:"F11"},{id:"shape",parent:null},{id:"addNode",parent:"shape"},{id:"deleteNode",parent:"shape"},{id:"moveNode",parent:"shape"},{id:"resizeNode",parent:"shape"},{id:"rotateNode",parent:"shape"},{id:"changeNodeColor",parent:"shape"},{id:"changeNodeBorder",parent:"shape"},{id:"changeNodeText",parent:"shape"},{id:"groupNodes",parent:"shape"},{id:"ungroupNodes",parent:"shape"},{id:"lockNode",parent:"shape"},{id:"unlockNode",parent:"shape"},{id:"connection",parent:null},{id:"addEdge",parent:"connection"},{id:"deleteEdge",parent:"connection"},{id:"changeEdgeStyle",parent:"connection"},{id:"changeEdgeColor",parent:"connection"},{id:"changeEdgeLabel",parent:"connection"},{id:"reverseEdge",parent:"connection"},{id:"text",parent:null},{id:"addText",parent:"text"},{id:"editText",parent:"text"},{id:"changeFont",parent:"text"},{id:"changeFontSize",parent:"text"},{id:"changeFontColor",parent:"text"},{id:"boldText",parent:"text",shortcut:"Ctrl+B"},{id:"italicText",parent:"text",shortcut:"Ctrl+I"},{id:"underlineText",parent:"text",shortcut:"Ctrl+U"},{id:"alignText",parent:"text"},{id:"layer",parent:null},{id:"sendToBack",parent:"layer"},{id:"bringToFront",parent:"layer"},{id:"sendBackward",parent:"layer"},{id:"bringForward",parent:"layer"},{id:"duplicateLayer",parent:"layer"},{id:"deleteLayer",parent:"layer"},{id:"toggleLayerVisibility",parent:"layer"}],sn={actions:Object.fromEntries(on.map(t=>[t.id,{...t,disabled:!1}]))},ce=V({name:"menu",initialState:sn,reducers:{setDisabled:(t,e)=>{t.actions[e.payload.id]&&(t.actions[e.payload.id].disabled=e.payload.disabled)},triggerAction:(t,e)=>{const o=t.actions[e.payload];o&&o.disabled}}}),{setDisabled:fn,triggerAction:bn}=ce.actions,ln=ce.reducer,nn=[{id:"save",icon:"save",disabled:!0,divide:!0},{id:"undo",icon:"undo",disabled:!0},{id:"redo",icon:"redo",disabled:!0,divide:!0},{id:"delete",icon:"trash",disabled:!1},{id:"add",icon:"cross",disabled:!1,divide:!0},{id:"layerUp",icon:"layers",disabled:!1},{id:"layerDown",icon:"layers",disabled:!1},{id:"layerTop",icon:"layers",disabled:!1},{id:"layerBottom",icon:"layers",disabled:!1,divide:!0},{id:"group",icon:"group",disabled:!0},{id:"ungroup",icon:"ungroup",disabled:!0,divide:!0},{id:"lock",icon:"lock",disabled:!1},{id:"unlock",icon:"unlock",disabled:!0}],an={actions:Object.fromEntries(nn.map(t=>[t.id,{...t,disabled:!1}]))},de=V({name:"menu",initialState:an,reducers:{setDisabled:(t,e)=>{t.actions[e.payload.id]&&(t.actions[e.payload.id].disabled=e.payload.disabled)},triggerAction:(t,e)=>{const o=t.actions[e.payload];o&&o.disabled}}}),{setDisabled:gn,triggerAction:mn}=de.actions,rn=de.reducer,cn={zoom:1},he=V({name:"statusBar",initialState:cn,reducers:{setZoom:(t,e)=>{t.zoom=e.payload}}}),{setZoom:xn}=he.actions,dn=he.reducer,hn=Le({reducer:{menu:ln,toolbar:rn,statusBar:dn}});Ae.createRoot(document.getElementById("root")).render(n.jsx(De,{store:hn,children:n.jsx(tn,{})}));
